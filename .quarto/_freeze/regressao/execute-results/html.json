{
  "hash": "d9b361df9d61e1ee8608511b4e5a305e",
  "result": {
    "markdown": "---\ntitle: \"\"\n---\n\n\n\n\n### Importando os dados \n\n\n::: {.cell hash='regressao_cache/html/unnamed-chunk-1_22857a0dca5926699af402d76c3c63c6'}\n\n```{.r .cell-code}\nlibrary(gsheet)\nlibrary(tidyverse)\nmilho <- gsheet2tbl(\"https://docs.google.com/spreadsheets/d/1bq2N19DcZdtax2fQW9OHSGMR0X2__Z9T/edit#gid=1345524759\")\nmilho <- milho |> \n  mutate(TRAT = as.factor(hybrid),\n         BLOCO = as.factor(block))\n```\n:::\n\n\n### Visualisa\n\n\n::: {.cell hash='regressao_cache/html/unnamed-chunk-2_4227bfde35c40e1cc4ab04b54cb1a2e7'}\n\n```{.r .cell-code}\ndfc <- milho |> \n  ggplot(aes(hybrid, index ))+\n  geom_jitter(width = 0.05, color = \"gray70\")+\n  stat_summary(fun.data = \"mean_cl_boot\", size =0.5, color = \"black\", alpha = 0.5)\ndfc\n```\n\n::: {.cell-output-display}\n![](regressao_files/figure-html/unnamed-chunk-2-1.png){width=672}\n:::\n\n```{.r .cell-code}\ndfc <- milho |> \n  ggplot(aes(hybrid, yield ))+\n  geom_jitter(width = 0.05, color = \"gray70\")+\n  stat_summary(fun.data = \"mean_cl_boot\", size =0.5, color = \"black\", alpha = 0.5)\ndfc\n```\n\n::: {.cell-output-display}\n![](regressao_files/figure-html/unnamed-chunk-2-2.png){width=672}\n:::\n:::\n\n\n## Index\n\n\n::: {.cell hash='regressao_cache/html/unnamed-chunk-3_9f02d71d74dca8831fa2326914438494'}\n\n```{.r .cell-code}\nmilho %>% \nggplot(aes(method, index))+\n  geom_jitter(width = 0.1, alpha= 0.2) +\n  facet_wrap(~hybrid) +\n  stat_summary(fun.data = \"mean_cl_boot\", size= 0.5, color = \"blue\")\n```\n\n::: {.cell-output-display}\n![](regressao_files/figure-html/unnamed-chunk-3-1.png){width=672}\n:::\n:::\n\n\n### Modelo para subdivida\n\n\n::: {.cell hash='regressao_cache/html/unnamed-chunk-4_042b32d7e66705f3a0a966a8a73e486f'}\n\n```{.r .cell-code}\nlibrary(lme4)\nlibrary(car)\n\n\nmilho<- milho %>% \n  mutate(block = as.factor(block))\n\nmix2 <- lmer(index ~ hybrid*method + block +       #fator fixo \n               (1|block/hybrid), data = milho)\n\nAnova(mix2)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\nAnalysis of Deviance Table (Type II Wald chisquare tests)\n\nResponse: index\n                Chisq Df Pr(>Chisq)   \nhybrid        15.5971  5   0.008094 **\nmethod         4.6963  1   0.030228 * \nblock          0.2157  3   0.975023   \nhybrid:method 15.8060  5   0.007420 **\n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n```\n:::\n\n```{.r .cell-code}\n#para saber se esse modelo está correto temo que testar as premissas\n```\n:::\n\n\n### Testar as premissas\n\n\n::: {.cell hash='regressao_cache/html/unnamed-chunk-5_3b57eba7f82d1ee181a667014af718fa'}\n\n```{.r .cell-code}\nlibrary(performance)\n\ncheck_normality(mix2)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\nOK: residuals appear as normally distributed (p = 0.635).\n```\n:::\n\n```{.r .cell-code}\ncheck_heteroscedasticity(mix2)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\nWarning: Heteroscedasticity (non-constant error variance) detected (p = 0.009).\n```\n:::\n\n```{.r .cell-code}\nmix2 <- lmer(sqrt(index) ~ hybrid*method + block +        \n               (1|block/hybrid), data = milho)\n\nlibrary(DHARMa)\nplot(simulateResiduals(mix2))\n```\n\n::: {.cell-output-display}\n![](regressao_files/figure-html/unnamed-chunk-5-1.png){width=672}\n:::\n\n```{.r .cell-code}\nqqnorm(residuals(mix2))\nqqline(residuals(mix2))\n```\n\n::: {.cell-output-display}\n![](regressao_files/figure-html/unnamed-chunk-5-2.png){width=672}\n:::\n\n```{.r .cell-code}\nhist(residuals(mix2))\n```\n\n::: {.cell-output-display}\n![](regressao_files/figure-html/unnamed-chunk-5-3.png){width=672}\n:::\n\n```{.r .cell-code}\nlibrary(emmeans)\n\nmedias_milho <- emmeans(mix2,\n                        ~ hybrid | method,\n                        type = \"response\")\n\nmedias_milho2 <- emmeans(mix2,\n                        ~ method | hybrid,\n                        type = \"response\")\n\nlibrary(multcomp)\ncld(medias_milho, Letters = LETTERS)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\nmethod = pin:\n hybrid   response   SE   df lower.CL upper.CL .group\n BG7049H      19.4 10.7 6084     4.10     46.0  A    \n 30K64        20.3 10.9 6084     4.51     47.4  A    \n 30F53 YH     24.5 12.0 6084     6.61     53.7  AB   \n 30F53 HX     25.0 12.1 6084     6.84     54.4  AB   \n 30S31YH      31.7 13.7 6084    10.57     64.2  AB   \n 30S31H       37.1 14.8 6084    13.79     71.8   B   \n\nmethod = silk:\n hybrid   response   SE   df lower.CL upper.CL .group\n BG7049H      19.1 10.6 6084     3.96     45.6  A    \n 30K64        21.3 11.2 6084     5.00     48.9  A    \n 30F53 HX     24.4 12.0 6084     6.56     53.6  A    \n 30F53 YH     26.0 12.4 6084     7.42     56.0  A    \n 30S31H       26.3 12.5 6084     7.57     56.4  A    \n 30S31YH      26.4 12.5 6084     7.62     56.5  A    \n\nResults are averaged over the levels of: block \nDegrees-of-freedom method: kenward-roger \nConfidence level used: 0.95 \nIntervals are back-transformed from the sqrt scale \nNote: contrasts are still on the sqrt scale \nP value adjustment: tukey method for comparing a family of 6 estimates \nsignificance level used: alpha = 0.05 \nNOTE: If two or more means share the same grouping symbol,\n      then we cannot show them to be different.\n      But we also did not show them to be the same. \n```\n:::\n\n```{.r .cell-code}\ncld(medias_milho2)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\nhybrid = 30F53 HX:\n method response   SE   df lower.CL upper.CL .group\n silk       24.4 12.0 6084     6.56     53.6  1    \n pin        25.0 12.1 6084     6.84     54.4  1    \n\nhybrid = 30F53 YH:\n method response   SE   df lower.CL upper.CL .group\n pin        24.5 12.0 6084     6.61     53.7  1    \n silk       26.0 12.4 6084     7.42     56.0  1    \n\nhybrid = 30K64:\n method response   SE   df lower.CL upper.CL .group\n pin        20.3 10.9 6084     4.51     47.4  1    \n silk       21.3 11.2 6084     5.00     48.9  1    \n\nhybrid = 30S31H:\n method response   SE   df lower.CL upper.CL .group\n silk       26.3 12.5 6084     7.57     56.4  1    \n pin        37.1 14.8 6084    13.79     71.8   2   \n\nhybrid = 30S31YH:\n method response   SE   df lower.CL upper.CL .group\n silk       26.4 12.5 6084     7.62     56.5  1    \n pin        31.7 13.7 6084    10.57     64.2  1    \n\nhybrid = BG7049H:\n method response   SE   df lower.CL upper.CL .group\n silk       19.1 10.6 6084     3.96     45.6  1    \n pin        19.4 10.7 6084     4.10     46.0  1    \n\nResults are averaged over the levels of: block \nDegrees-of-freedom method: kenward-roger \nConfidence level used: 0.95 \nIntervals are back-transformed from the sqrt scale \nNote: contrasts are still on the sqrt scale \nsignificance level used: alpha = 0.05 \nNOTE: If two or more means share the same grouping symbol,\n      then we cannot show them to be different.\n      But we also did not show them to be the same. \n```\n:::\n:::\n\n::: {.cell hash='regressao_cache/html/unnamed-chunk-6_5c5ffe2b831def3b1308692cdb002284'}\n\n```{.r .cell-code}\nmix3 <- lmer(sqrt(yield) ~ hybrid*method + block +        \n               (1|block/hybrid), data = milho)\n\nAnova(mix3)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\nAnalysis of Deviance Table (Type II Wald chisquare tests)\n\nResponse: sqrt(yield)\n                Chisq Df Pr(>Chisq)    \nhybrid        25.5591  5  0.0001086 ***\nmethod         0.0520  1  0.8196750    \nblock          2.3606  3  0.5010021    \nhybrid:method 24.4985  5  0.0001741 ***\n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n```\n:::\n\n```{.r .cell-code}\ncheck_heteroscedasticity(mix3)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\nOK: Error variance appears to be homoscedastic (p = 0.686).\n```\n:::\n\n```{.r .cell-code}\ncheck_normality(mix3)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\nOK: residuals appear as normally distributed (p = 0.214).\n```\n:::\n:::\n\n\n## Regressão linear\n\n\n::: {.cell hash='regressao_cache/html/unnamed-chunk-7_e29073ece944057ef0135cca0c258242'}\n\n```{.r .cell-code}\nestande <- gsheet2tbl(\"https://docs.google.com/spreadsheets/d/1bq2N19DcZdtax2fQW9OHSGMR0X2__Z9T/edit#gid=401662555\")\n\nestande\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n# A tibble: 72 × 4\n     exp  trat bloco nplants\n   <dbl> <dbl> <dbl>   <dbl>\n 1     1     0     1      66\n 2     1     0     2      72\n 3     1     0     3      50\n 4     1     0     4      27\n 5     1     3     1      68\n 6     1     3     2      79\n 7     1     3     3      31\n 8     1     3     4      32\n 9     1     6     1      58\n10     1     6     2      56\n# ℹ 62 more rows\n```\n:::\n:::\n\n::: {.cell hash='regressao_cache/html/unnamed-chunk-8_11edc9365ce3d8bd5680db7a7aa17da5'}\n\n```{.r .cell-code}\nestande |>\n  ggplot(aes(trat, nplants))+\n  geom_jitter(wdth = 0.1, alpha = 0.2) +\n  facet_wrap(~ exp) +\n   stat_summary(fun.data = \"mean_cl_boot\", size= 0.5, color = \"blue\") +\n  geom_smooth(method = \"lm\", se = F)    #regresão linear\n```\n\n::: {.cell-output-display}\n![](regressao_files/figure-html/unnamed-chunk-8-1.png){width=672}\n:::\n\n```{.r .cell-code}\n  exp1 <- estande %>% \n    filter(exp == 1)\n  \n  exp1 %>% \n    ggplot(aes(trat, nplants))+\n    geom_point()+\n    ylim(0,100) +\n    geom_smooth(se = F, method = lm)\n```\n\n::: {.cell-output-display}\n![](regressao_files/figure-html/unnamed-chunk-8-2.png){width=672}\n:::\n\n```{.r .cell-code}\n  #modelo linear\n  \n  lm1 <- lm(nplants~ trat,\n            data = exp1)\nsummary(lm1)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n\nCall:\nlm(formula = nplants ~ trat, data = exp1)\n\nResiduals:\n    Min      1Q  Median      3Q     Max \n-25.500  -6.532   1.758   8.573  27.226 \n\nCoefficients:\n            Estimate Std. Error t value Pr(>|t|)    \n(Intercept)  52.5000     4.2044  12.487 1.84e-11 ***\ntrat         -0.2419     0.1859  -1.301    0.207    \n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\nResidual standard error: 15 on 22 degrees of freedom\nMultiple R-squared:  0.07148,\tAdjusted R-squared:  0.02928 \nF-statistic: 1.694 on 1 and 22 DF,  p-value: 0.2066\n```\n:::\n\n```{.r .cell-code}\n exp2 <- estande %>% \n    filter(exp == 2)\n  \n  exp2 %>% \n    ggplot(aes(trat, nplants))+\n    geom_point()+\n    ylim(0,100) +\n    geom_smooth(se = F, method = lm)\n```\n\n::: {.cell-output-display}\n![](regressao_files/figure-html/unnamed-chunk-8-3.png){width=672}\n:::\n\n```{.r .cell-code}\n lm2 <- lm(nplants~ trat,\n            data = exp2)\nsummary(lm2)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n\nCall:\nlm(formula = nplants ~ trat, data = exp2)\n\nResiduals:\n     Min       1Q   Median       3Q      Max \n-25.7816  -7.7150   0.5653   8.1929  19.2184 \n\nCoefficients:\n            Estimate Std. Error t value Pr(>|t|)    \n(Intercept)  60.9857     3.6304  16.798 4.93e-14 ***\ntrat         -0.7007     0.1605  -4.365 0.000247 ***\n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\nResidual standard error: 12.95 on 22 degrees of freedom\nMultiple R-squared:  0.4641,\tAdjusted R-squared:  0.4398 \nF-statistic: 19.05 on 1 and 22 DF,  p-value: 0.0002473\n```\n:::\n\n```{.r .cell-code}\n exp2 %>% \n    ggplot(aes(trat, nplants))+\n    geom_point()+\n    ylim(0,100) +\n    geom_smooth(se = F, method = lm)\n```\n\n::: {.cell-output-display}\n![](regressao_files/figure-html/unnamed-chunk-8-4.png){width=672}\n:::\n\n```{.r .cell-code}\n lm2 <- lm(nplants~ trat,\n            data = exp2)\nsummary(lm2)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n\nCall:\nlm(formula = nplants ~ trat, data = exp2)\n\nResiduals:\n     Min       1Q   Median       3Q      Max \n-25.7816  -7.7150   0.5653   8.1929  19.2184 \n\nCoefficients:\n            Estimate Std. Error t value Pr(>|t|)    \n(Intercept)  60.9857     3.6304  16.798 4.93e-14 ***\ntrat         -0.7007     0.1605  -4.365 0.000247 ***\n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\nResidual standard error: 12.95 on 22 degrees of freedom\nMultiple R-squared:  0.4641,\tAdjusted R-squared:  0.4398 \nF-statistic: 19.05 on 1 and 22 DF,  p-value: 0.0002473\n```\n:::\n\n```{.r .cell-code}\n exp3 <- estande %>% \n    filter(exp == 3)\n  \n  exp3 %>% \n    ggplot(aes(trat, nplants))+\n    geom_point()+\n    ylim(0,100) +\n    geom_smooth(se = F, method = lm)\n```\n\n::: {.cell-output-display}\n![](regressao_files/figure-html/unnamed-chunk-8-5.png){width=672}\n:::\n\n```{.r .cell-code}\n lm3 <- lm(nplants~ trat,\n            data = exp3)\nsummary(lm3)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n\nCall:\nlm(formula = nplants ~ trat, data = exp3)\n\nResiduals:\n     Min       1Q   Median       3Q      Max \n-26.5887  -3.9597   0.7177   5.5806  19.8952 \n\nCoefficients:\n            Estimate Std. Error t value Pr(>|t|)    \n(Intercept)  95.7500     2.9529  32.425  < 2e-16 ***\ntrat         -0.7634     0.1306  -5.847 6.97e-06 ***\n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\nResidual standard error: 10.53 on 22 degrees of freedom\nMultiple R-squared:  0.6085,\tAdjusted R-squared:  0.5907 \nF-statistic: 34.19 on 1 and 22 DF,  p-value: 6.968e-06\n```\n:::\n:::\n\n\n\n#### Modelo quadratico\n\n\n\n::: {.cell hash='regressao_cache/html/unnamed-chunk-9_08d8ed00b8647722968d3acd48006061'}\n\n```{.r .cell-code}\nexp2 %>% \n    ggplot(aes(trat, nplants))+\n    geom_point()+\n    ylim(0,100) +\n    geom_smooth(method = \"lm\",\n                se = FALSE,\n                formula = y ~poly(x,2),\n                color = \"black\")\n```\n\n::: {.cell-output-display}\n![](regressao_files/figure-html/unnamed-chunk-9-1.png){width=672}\n:::\n\n```{.r .cell-code}\n# Comparando o modelo linear com o quadradatico: \n\nexp2 %>% \n    ggplot(aes(trat, nplants))+\n    geom_point()+\n    ylim(0,100) +\n    geom_smooth(method = lm,\n                se = FALSE,\n                formula = y ~poly(x,2),\n                color = \"black\") +\n  geom_smooth(method = \"lm\", se = FALSE)\n```\n\n::: {.cell-output-display}\n![](regressao_files/figure-html/unnamed-chunk-9-2.png){width=672}\n:::\n\n```{.r .cell-code}\n lm2 <- lm(nplants~ trat,\n            data = exp2)\n \nsummary(lm2)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n\nCall:\nlm(formula = nplants ~ trat, data = exp2)\n\nResiduals:\n     Min       1Q   Median       3Q      Max \n-25.7816  -7.7150   0.5653   8.1929  19.2184 \n\nCoefficients:\n            Estimate Std. Error t value Pr(>|t|)    \n(Intercept)  60.9857     3.6304  16.798 4.93e-14 ***\ntrat         -0.7007     0.1605  -4.365 0.000247 ***\n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\nResidual standard error: 12.95 on 22 degrees of freedom\nMultiple R-squared:  0.4641,\tAdjusted R-squared:  0.4398 \nF-statistic: 19.05 on 1 and 22 DF,  p-value: 0.0002473\n```\n:::\n\n```{.r .cell-code}\nhist(residuals(lm2))\n```\n\n::: {.cell-output-display}\n![](regressao_files/figure-html/unnamed-chunk-9-3.png){width=672}\n:::\n\n```{.r .cell-code}\n# Ajustar o modelo quadratico: para ter mais um coeficiente neste modelo (^2)\n\n# Primeira ordem\n\nexp2$trat2 <- exp2$trat^2\n\n# Segunda ordem\n\nlm3<- lm(nplants ~trat + trat2,\n         data = exp2)\nsummary(lm3)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n\nCall:\nlm(formula = nplants ~ trat + trat2, data = exp2)\n\nResiduals:\n    Min      1Q  Median      3Q     Max \n-25.439  -6.019   1.789   8.016  19.561 \n\nCoefficients:\n            Estimate Std. Error t value Pr(>|t|)    \n(Intercept) 66.30156    4.42097  14.997 1.08e-12 ***\ntrat        -1.77720    0.58467  -3.040  0.00623 ** \ntrat2        0.02223    0.01166   1.906  0.07036 .  \n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\nResidual standard error: 12.24 on 21 degrees of freedom\nMultiple R-squared:  0.5432,\tAdjusted R-squared:  0.4997 \nF-statistic: 12.49 on 2 and 21 DF,  p-value: 0.0002675\n```\n:::\n\n```{.r .cell-code}\n#o r2 aumentou, explicando MELHOR. 50% DA VARIAÇÃO\n\nAIC(lm2)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n[1] 194.9597\n```\n:::\n\n```{.r .cell-code}\nAIC(lm3)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n[1] 193.1284\n```\n:::\n\n```{.r .cell-code}\nexp2$trat2 <- exp2$trat^2\n\n#primeira ordem\nexp2$trat2 <- exp2$trat^2\n\n# segunda ordem ou quadratico\nlm3<- lm(nplants ~trat + trat2,\n         data = exp2)\nsummary(lm3)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n\nCall:\nlm(formula = nplants ~ trat + trat2, data = exp2)\n\nResiduals:\n    Min      1Q  Median      3Q     Max \n-25.439  -6.019   1.789   8.016  19.561 \n\nCoefficients:\n            Estimate Std. Error t value Pr(>|t|)    \n(Intercept) 66.30156    4.42097  14.997 1.08e-12 ***\ntrat        -1.77720    0.58467  -3.040  0.00623 ** \ntrat2        0.02223    0.01166   1.906  0.07036 .  \n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\nResidual standard error: 12.24 on 21 degrees of freedom\nMultiple R-squared:  0.5432,\tAdjusted R-squared:  0.4997 \nF-statistic: 12.49 on 2 and 21 DF,  p-value: 0.0002675\n```\n:::\n\n```{.r .cell-code}\n#o r2 aumentou, explicando MELHOR. 50% DA VARIAÇÃO\nAIC(lm2)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n[1] 194.9597\n```\n:::\n\n```{.r .cell-code}\nAIC(lm3)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n[1] 193.1284\n```\n:::\n:::\n\n\n#### Fazendo a mesmo coisa pelo agroR\n\n\n::: {.cell hash='regressao_cache/html/unnamed-chunk-10_4afe6c42f3b99bb4ab815c56ae154969'}\n\n```{.r .cell-code}\nlibrary(AgroR)\n\nwith(exp2, polynomial(trat, nplants, grau = 1))\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n\n----------------------------------------------------\nRegression Models\n----------------------------------------------------\n              Estimate Std. Error   t value     Pr(>|t|)\n(Intercept) 60.9857143  3.6304377 16.798447 4.929311e-14\ntrat        -0.7006912  0.1605226 -4.365063 2.473272e-04\n\n----------------------------------------------------\nDeviations from regression\n----------------------------------------------------\n          Df      SSq       MSQ        F      p-value\nLinear     1 3196.203 3196.2031 21.82329 0.0001899378\nDeviation  4 1054.172  263.5430  1.79944 0.1729687460\nResidual  18 2636.250  146.4583                      \n```\n:::\n\n::: {.cell-output .cell-output-stdout}\n```\n[[1]]\n```\n:::\n\n::: {.cell-output-display}\n![](regressao_files/figure-html/unnamed-chunk-10-1.png){width=672}\n:::\n\n```{.r .cell-code}\n#polynomial(trat, nplants, grau = 1, data = exp2)\n\nwith(exp2, polynomial(trat, nplants, grau = 2))\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n\n----------------------------------------------------\nRegression Models\n----------------------------------------------------\n               Estimate Std. Error   t value     Pr(>|t|)\n(Intercept) 66.30156250 4.42096799 14.997069 1.079972e-12\ntrat        -1.77719814 0.58467380 -3.039640 6.230050e-03\nI(trat^2)    0.02222876 0.01165948  1.906496 7.036247e-02\n\n----------------------------------------------------\nDeviations from regression\n----------------------------------------------------\n          Df       SSq       MSQ         F      p-value\nLinear     1 3196.2031 3196.2031 21.823293 0.0001899378\nQuadratic  1  544.5029  544.5029  3.717801 0.0697619482\nDeviation  3  509.6690  169.8897  1.159986 0.3523240106\nResidual  18 2636.2500  146.4583                       \n```\n:::\n\n::: {.cell-output .cell-output-stdout}\n```\n[[1]]\n```\n:::\n\n::: {.cell-output-display}\n![](regressao_files/figure-html/unnamed-chunk-10-2.png){width=672}\n:::\n\n```{.r .cell-code}\n# Grau 3 não utilizamos porque não tem explicação biologica.\n\nwith(exp2, polynomial(trat, nplants, grau = 3))\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n\n----------------------------------------------------\nRegression Models\n----------------------------------------------------\n                Estimate  Std. Error   t value     Pr(>|t|)\n(Intercept) 70.265143802 5.300440019 13.256474 2.295186e-11\ntrat        -3.609380523 1.514625525 -2.383018 2.720299e-02\nI(trat^2)    0.140522077 0.091192577  1.540938 1.390058e-01\nI(trat^3)   -0.001712445 0.001309648 -1.307561 2.058546e-01\n\n----------------------------------------------------\nDeviations from regression\n----------------------------------------------------\n          Df       SSq       MSQ          F      p-value\nLinear     1 3196.2031 3196.2031 21.8232929 0.0001899378\nQuadratic  1  544.5029  544.5029  3.7178008 0.0697619482\nCubic      1  247.7520  247.7520  1.6916208 0.2097934169\nDeviation  2  261.9170  130.9585  0.8941691 0.4263523326\nResidual  18 2636.2500  146.4583                        \n```\n:::\n\n::: {.cell-output .cell-output-stdout}\n```\n[[1]]\n```\n:::\n\n::: {.cell-output-display}\n![](regressao_files/figure-html/unnamed-chunk-10-3.png){width=672}\n:::\n\n```{.r .cell-code}\n#library(agro3)\n#with(exp2, polynomial(trat, nplants, grau = 2))\n#data(\"phao\")\n#with(phao, polynomial(dose, comp, grau = 2))\n```\n:::\n\n::: {.cell hash='regressao_cache/html/unnamed-chunk-11_39967e76df2b4b9f0df63a4f58a3bbb8'}\n\n```{.r .cell-code}\nglm2 <- glm(nplants ~ trat, family = \"gaussian\", \n            data = exp2)\nglm2\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n\nCall:  glm(formula = nplants ~ trat, family = \"gaussian\", data = exp2)\n\nCoefficients:\n(Intercept)         trat  \n    60.9857      -0.7007  \n\nDegrees of Freedom: 23 Total (i.e. Null);  22 Residual\nNull Deviance:\t    6887 \nResidual Deviance: 3690 \tAIC: 195\n```\n:::\n\n```{.r .cell-code}\nsummary(glm2)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n\nCall:\nglm(formula = nplants ~ trat, family = \"gaussian\", data = exp2)\n\nCoefficients:\n            Estimate Std. Error t value Pr(>|t|)    \n(Intercept)  60.9857     3.6304  16.798 4.93e-14 ***\ntrat         -0.7007     0.1605  -4.365 0.000247 ***\n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\n(Dispersion parameter for gaussian family taken to be 167.7464)\n\n    Null deviance: 6886.6  on 23  degrees of freedom\nResidual deviance: 3690.4  on 22  degrees of freedom\nAIC: 194.96\n\nNumber of Fisher Scoring iterations: 2\n```\n:::\n\n```{.r .cell-code}\nAIC(glm2)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n[1] 194.9597\n```\n:::\n\n```{.r .cell-code}\nglm2b <- glm(nplants ~ trat, family = \"poisson\" (link = log),\n             data = exp2)\n\nsummary(glm2b)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n\nCall:\nglm(formula = nplants ~ trat, family = poisson(link = log), data = exp2)\n\nCoefficients:\n             Estimate Std. Error z value Pr(>|z|)    \n(Intercept)  4.134189   0.037583 110.003  < 2e-16 ***\ntrat        -0.016270   0.002059  -7.901 2.76e-15 ***\n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\n(Dispersion parameter for poisson family taken to be 1)\n\n    Null deviance: 139.783  on 23  degrees of freedom\nResidual deviance:  69.578  on 22  degrees of freedom\nAIC: 210.24\n\nNumber of Fisher Scoring iterations: 4\n```\n:::\n\n```{.r .cell-code}\nAIC(glm2b)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n[1] 210.2353\n```\n:::\n\n```{.r .cell-code}\nglm3 <- glm(nplants ~ trat, family = \"gaussian\", \n            data = exp3)\nglm3\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n\nCall:  glm(formula = nplants ~ trat, family = \"gaussian\", data = exp3)\n\nCoefficients:\n(Intercept)         trat  \n    95.7500      -0.7634  \n\nDegrees of Freedom: 23 Total (i.e. Null);  22 Residual\nNull Deviance:\t    6236 \nResidual Deviance: 2442 \tAIC: 185\n```\n:::\n\n```{.r .cell-code}\nsummary(glm3)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n\nCall:\nglm(formula = nplants ~ trat, family = \"gaussian\", data = exp3)\n\nCoefficients:\n            Estimate Std. Error t value Pr(>|t|)    \n(Intercept)  95.7500     2.9529  32.425  < 2e-16 ***\ntrat         -0.7634     0.1306  -5.847 6.97e-06 ***\n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\n(Dispersion parameter for gaussian family taken to be 110.9787)\n\n    Null deviance: 6235.8  on 23  degrees of freedom\nResidual deviance: 2441.5  on 22  degrees of freedom\nAIC: 185.04\n\nNumber of Fisher Scoring iterations: 2\n```\n:::\n\n```{.r .cell-code}\nAIC(glm3)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n[1] 185.0449\n```\n:::\n\n```{.r .cell-code}\nglm3b <- glm(nplants ~ trat, family = \"poisson\" (link = log),\n             data = exp3)\n\nsummary(glm3b)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n\nCall:\nglm(formula = nplants ~ trat, family = poisson(link = log), data = exp3)\n\nCoefficients:\n             Estimate Std. Error z value Pr(>|z|)    \n(Intercept)  4.571590   0.029539 154.762  < 2e-16 ***\ntrat        -0.009965   0.001488  -6.697 2.13e-11 ***\n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\n(Dispersion parameter for poisson family taken to be 1)\n\n    Null deviance: 77.906  on 23  degrees of freedom\nResidual deviance: 29.952  on 22  degrees of freedom\nAIC: 183.93\n\nNumber of Fisher Scoring iterations: 4\n```\n:::\n\n```{.r .cell-code}\nAIC(glm3b)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n[1] 183.9324\n```\n:::\n\n```{.r .cell-code}\nlibrary(lme4)\n\nglm3 <- glmer(nplants ~ trat + (trat | exp), family = \"gaussian\", \n            data = estande)\nglm3\n```\n\n::: {.cell-output .cell-output-stdout}\n```\nLinear mixed model fit by REML ['lmerMod']\nFormula: nplants ~ trat + (trat | exp)\n   Data: estande\nREML criterion at convergence: 580.8402\nRandom effects:\n Groups   Name        Std.Dev. Corr \n exp      (Intercept) 22.5983       \n          trat         0.2349  -0.82\n Residual             12.9581       \nNumber of obs: 72, groups:  exp, 3\nFixed Effects:\n(Intercept)         trat  \n    69.7452      -0.5687  \noptimizer (nloptwrap) convergence code: 0 (OK) ; 0 optimizer warnings; 1 lme4 warnings \n```\n:::\n\n```{.r .cell-code}\nsummary(glm3)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\nLinear mixed model fit by REML ['lmerMod']\nFormula: nplants ~ trat + (trat | exp)\n   Data: estande\n\nREML criterion at convergence: 580.8\n\nScaled residuals: \n    Min      1Q  Median      3Q     Max \n-2.0988 -0.6091  0.1722  0.6360  1.9963 \n\nRandom effects:\n Groups   Name        Variance  Std.Dev. Corr \n exp      (Intercept) 510.68405 22.5983       \n          trat          0.05516  0.2349  -0.82\n Residual             167.91303 12.9581       \nNumber of obs: 72, groups:  exp, 3\n\nFixed effects:\n            Estimate Std. Error t value\n(Intercept)  69.7452    13.2146   5.278\ntrat         -0.5687     0.1643  -3.462\n\nCorrelation of Fixed Effects:\n     (Intr)\ntrat -0.731\noptimizer (nloptwrap) convergence code: 0 (OK)\nModel failed to converge with max|grad| = 0.00274249 (tol = 0.002, component 1)\n```\n:::\n\n```{.r .cell-code}\nAIC(glm3)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n[1] 592.8402\n```\n:::\n\n```{.r .cell-code}\nglm3b <- glmer(nplants ~ trat + ( trat | exp), family = \"poisson\" (link = \"log\"),\n             data = estande)\n\nsummary(glm3b)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\nGeneralized linear mixed model fit by maximum likelihood (Laplace\n  Approximation) [glmerMod]\n Family: poisson  ( log )\nFormula: nplants ~ trat + (trat | exp)\n   Data: estande\n\n     AIC      BIC   logLik deviance df.resid \n   660.7    672.1   -325.4    650.7       67 \n\nScaled residuals: \n    Min      1Q  Median      3Q     Max \n-3.6247 -0.8083  0.1042  0.9601  3.6511 \n\nRandom effects:\n Groups Name        Variance  Std.Dev. Corr \n exp    (Intercept) 6.425e-02 0.253478      \n        trat        1.602e-05 0.004003 -0.17\nNumber of obs: 72, groups:  exp, 3\n\nFixed effects:\n             Estimate Std. Error z value Pr(>|z|)    \n(Intercept)  4.223397   0.147793  28.577  < 2e-16 ***\ntrat        -0.010434   0.002538  -4.111 3.93e-05 ***\n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\nCorrelation of Fixed Effects:\n     (Intr)\ntrat -0.192\n```\n:::\n\n```{.r .cell-code}\nAIC(glm3b)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n[1] 660.7282\n```\n:::\n\n```{.r .cell-code}\n#remotes::install_github(\"emdelponte/r4pe\")\n\nlibrary(r4pde)\nwm <- WhiteMoldSoybean\n\nwm %>% \n  ggplot(aes(inc, yld)) +\n  geom_point() +\n  facet_wrap(~study) +\n  theme_minimal()\n```\n\n::: {.cell-output-display}\n![](regressao_files/figure-html/unnamed-chunk-11-1.png){width=672}\n:::\n\n```{.r .cell-code}\nmofo1 <- lm(yld ~ inc,\n            data = wm)\nsummary(mofo1)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n\nCall:\nlm(formula = yld ~ inc, data = wm)\n\nResiduals:\n     Min       1Q   Median       3Q      Max \n-1657.85  -594.50   -91.32   531.76  1693.15 \n\nCoefficients:\n            Estimate Std. Error t value Pr(>|t|)    \n(Intercept) 3299.619     56.451  58.451  < 2e-16 ***\ninc           -9.261      2.108  -4.393 1.45e-05 ***\n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\nResidual standard error: 745.8 on 380 degrees of freedom\nMultiple R-squared:  0.04833,\tAdjusted R-squared:  0.04582 \nF-statistic:  19.3 on 1 and 380 DF,  p-value: 1.452e-05\n```\n:::\n\n```{.r .cell-code}\nwm %>% \n  ggplot(aes(inc, yld , group = factor(study))) +\n  geom_point() +\n  theme_minimal() +\n  geom_smooth(method = \"lm\", se = F) \n```\n\n::: {.cell-output-display}\n![](regressao_files/figure-html/unnamed-chunk-11-2.png){width=672}\n:::\n\n```{.r .cell-code}\nmofo1 <- lm(yld ~ inc,\n            data = wm)\nsummary(mofo1)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n\nCall:\nlm(formula = yld ~ inc, data = wm)\n\nResiduals:\n     Min       1Q   Median       3Q      Max \n-1657.85  -594.50   -91.32   531.76  1693.15 \n\nCoefficients:\n            Estimate Std. Error t value Pr(>|t|)    \n(Intercept) 3299.619     56.451  58.451  < 2e-16 ***\ninc           -9.261      2.108  -4.393 1.45e-05 ***\n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\nResidual standard error: 745.8 on 380 degrees of freedom\nMultiple R-squared:  0.04833,\tAdjusted R-squared:  0.04582 \nF-statistic:  19.3 on 1 and 380 DF,  p-value: 1.452e-05\n```\n:::\n:::\n\n::: {.cell hash='regressao_cache/html/unnamed-chunk-12_52d285108e55df18fab5eb095f6a1b89'}\n\n```{.r .cell-code}\nlibrary(broom)\n\nmofo2 <- wm %>% \n  group_by(study) %>% \n  do (tidy(lm(.$yld ~ .$inc), conf.int = TRUE))\nmofo2\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n# A tibble: 70 × 8\n# Groups:   study [35]\n   study term        estimate std.error statistic  p.value conf.low conf.high\n   <dbl> <chr>          <dbl>     <dbl>     <dbl>    <dbl>    <dbl>     <dbl>\n 1     1 (Intercept)  3329.       86.8      38.3  4.60e-13   3138.    3520.  \n 2     1 .$inc         -14.2       2.08     -6.85 2.78e- 5    -18.8     -9.64\n 3     2 (Intercept)  2682.       48.6      55.2  8.55e-15   2575.    2789.  \n 4     2 .$inc          -6.93      1.49     -4.66 6.89e- 4    -10.2     -3.66\n 5     3 (Intercept)  4017.       61.6      65.2  1.37e-15   3882.    4153.  \n 6     3 .$inc         -18.6       1.71    -10.9  3.11e- 7    -22.4    -14.9 \n 7     4 (Intercept)  2814.      151.       18.6  1.15e- 9   2481.    3147.  \n 8     4 .$inc         -43.5      16.8      -2.58 2.56e- 2    -80.5     -6.38\n 9     5 (Intercept)  3317.      234.       14.2  2.07e- 8   2802.    3832.  \n10     5 .$inc         -21.2       5.69     -3.72 3.36e- 3    -33.7     -8.67\n# ℹ 60 more rows\n```\n:::\n\n```{.r .cell-code}\n#p3 <- fit_all |> \n # filter(term == \"(Intercept)\") |> \n # ggplot(aes(x = estimate))+\n # geom_histogram(bins = 8, color = \"white\", fill = \"gray50\")+\n #theme_r4pde()+\n  #labs(x = \"Intercept\", y = \"Frequency\")\n\n#p4 <- fit_all |> \n  #filter(term == \".$inc\") |> \n  #ggplot(aes(x = estimate))+\n  #geom_histogram(bins = 8, color = \"white\", fill = \"gray50\")+\n  #theme_r4pde()+\n  #labs(x = \"Slope\", y = \"Frequency\")\n\n\nlibrary(patchwork)\n#p3|p4\n\n\ndf <- mofo2 %>%  filter(term == \".$inc\")\nmean(df$estimate)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n[1] -19.52932\n```\n:::\n\n```{.r .cell-code}\nlibrary(patchwork)\n#p3|p4\n```\n:::\n\n::: {.cell hash='regressao_cache/html/unnamed-chunk-13_ab6a95c53d063d2010c630917ca23998'}\n\n```{.r .cell-code}\nlibrary(lme4)\n\nmofo3 <- lmer(yld ~ inc + (inc | study), data = wm,\n              REML = F)\n\nsummary(mofo3)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\nLinear mixed model fit by maximum likelihood  ['lmerMod']\nFormula: yld ~ inc + (inc | study)\n   Data: wm\n\n     AIC      BIC   logLik deviance df.resid \n  5319.4   5343.1  -2653.7   5307.4      376 \n\nScaled residuals: \n    Min      1Q  Median      3Q     Max \n-3.7078 -0.5991 -0.0295  0.5077  3.2364 \n\nRandom effects:\n Groups   Name        Variance  Std.Dev. Corr \n study    (Intercept) 557573.08 746.708       \n          inc             36.85   6.071  -0.29\n Residual              37228.73 192.947       \nNumber of obs: 382, groups:  study, 35\n\nFixed effects:\n            Estimate Std. Error t value\n(Intercept) 3455.432    128.063   26.98\ninc          -17.236      1.451  -11.88\n\nCorrelation of Fixed Effects:\n    (Intr)\ninc -0.300\noptimizer (nloptwrap) convergence code: 0 (OK)\nModel failed to converge with max|grad| = 0.416806 (tol = 0.002, component 1)\n```\n:::\n\n```{.r .cell-code}\nAnova(mofo3)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\nAnalysis of Deviance Table (Type II Wald chisquare tests)\n\nResponse: yld\n     Chisq Df Pr(>Chisq)    \ninc 141.09  1  < 2.2e-16 ***\n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n```\n:::\n\n```{.r .cell-code}\n#confint(mofo3, method = \"wald\")\n```\n:::\n",
    "supporting": [],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {},
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}