[
  {
    "objectID": "testet.html",
    "href": "testet.html",
    "title": "FIP606",
    "section": "",
    "text": "library(tidyverse)\nlibrary(emmeans)\nlibrary(report)\nlibrary(MASS)\nlibrary(agricolae)\nlibrary(see)\nlibrary(estimability)\nlibrary(car)"
  },
  {
    "objectID": "testet.html#pacotes-utilizados",
    "href": "testet.html#pacotes-utilizados",
    "title": "FIP606",
    "section": "",
    "text": "library(tidyverse)\nlibrary(emmeans)\nlibrary(report)\nlibrary(MASS)\nlibrary(agricolae)\nlibrary(see)\nlibrary(estimability)\nlibrary(car)"
  },
  {
    "objectID": "testet.html#inferencial",
    "href": "testet.html#inferencial",
    "title": "FIP606",
    "section": "Inferencial",
    "text": "Inferencial"
  },
  {
    "objectID": "testet.html#teste-t",
    "href": "testet.html#teste-t",
    "title": "FIP606",
    "section": "Teste T",
    "text": "Teste T\n\nDois grupos independentes\n\nlibrary(gsheet)\nmg &lt;- gsheet2tbl(\"https://docs.google.com/spreadsheets/d/1bq2N19DcZdtax2fQW9OHSGMR0X2__Z9T/edit#gid=983033137\")\n\n\nVisualização\n\nlibrary(ggplot2)\n\nmg |&gt; \n  ggplot(aes(trat, comp))+\n  geom_boxplot()\n\n\n\n\n\nTeste T - t.test\n\nmg2 &lt;- mg |&gt; \n  tidyr::pivot_wider(names_from = trat,\n              values_from = comp)\n\nteste1 &lt;- t.test(mg2$control, mg2$Mg2)\n\n\n\n\nTeste de normalidade\n\nshapiro.test(mg2$control)\n\n\n    Shapiro-Wilk normality test\n\ndata:  mg2$control\nW = 0.93886, p-value = 0.5404\n\nhist(mg2$control)\n\n\n\nshapiro.test(mg2$Mg2)\n\n\n    Shapiro-Wilk normality test\n\ndata:  mg2$Mg2\nW = 0.97269, p-value = 0.9146\n\nhist(mg2$Mg2)\n\n\n\n\nOutra forma de verificar a normalidade:\n\nqqnorm(mg2$control)\nqqline(mg2$control)\n\n\n\n\n\n\nTeste de variância\n\nvar.test(mg2$control, mg2$Mg2)\n\n\n    F test to compare two variances\n\ndata:  mg2$control and mg2$Mg2\nF = 0.67654, num df = 9, denom df = 9, p-value = 0.5698\nalternative hypothesis: true ratio of variances is not equal to 1\n95 percent confidence interval:\n 0.1680428 2.7237436\nsample estimates:\nratio of variances \n         0.6765394 \n\n\n\nt.test(mg2$control, mg2$Mg2,\n       var.equal = FALSE)\n\n\n    Welch Two Sample t-test\n\ndata:  mg2$control and mg2$Mg2\nt = 8.1549, df = 17.354, p-value = 2.423e-07\nalternative hypothesis: true difference in means is not equal to 0\n95 percent confidence interval:\n 3.825607 6.490393\nsample estimates:\nmean of x mean of y \n   15.678    10.520 \n\n\n\nreport(teste1)\n\nEffect sizes were labelled following Cohen's (1988) recommendations.\n\nThe Welch Two Sample t-test testing the difference between mg2$control and\nmg2$Mg2 (mean of x = 15.68, mean of y = 10.52) suggests that the effect is\npositive, statistically significant, and large (difference = 5.16, 95% CI\n[3.83, 6.49], t(17.35) = 8.15, p &lt; .001; Cohen's d = 3.65, 95% CI [2.14, 5.12])\n\n\n\nmicelial &lt;- gsheet2tbl(\"https://docs.google.com/spreadsheets/d/1bq2N19DcZdtax2fQW9OHSGMR0X2__Z9T/edit#gid=959387827\")\n\nmicelial |&gt; \n  ggplot(aes(especie, tcm))+\n  geom_jitter(width = 0.01)+\n  stat_summary(\n    geom = \"point\",\n    fun.y = \"mean\",\n    size = 3,\n    color = \"red\"\n  )\n\n\n\n\n\n\nTeste Anova\nObs: dados modificados anteriormente.\n\nm1 &lt;- lm(tcm ~especie, data = micelial)\n\nanova(m1)\n\nAnalysis of Variance Table\n\nResponse: tcm\n          Df  Sum Sq Mean Sq F value    Pr(&gt;F)    \nespecie    4 1.46958 0.36739  19.629 2.028e-07 ***\nResiduals 25 0.46792 0.01872                      \n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\nsummary(m1) \n\n\nCall:\nlm(formula = tcm ~ especie, data = micelial)\n\nResiduals:\n     Min       1Q   Median       3Q      Max \n-0.23667 -0.09667  0.01583  0.08833  0.28333 \n\nCoefficients:\n            Estimate Std. Error t value Pr(&gt;|t|)    \n(Intercept)  1.57167    0.05585  28.140  &lt; 2e-16 ***\nespecieFaus -0.33500    0.07899  -4.241 0.000266 ***\nespecieFcor -0.25000    0.07899  -3.165 0.004047 ** \nespecieFgra -0.66000    0.07899  -8.356 1.05e-08 ***\nespecieFmer -0.14500    0.07899  -1.836 0.078317 .  \n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\nResidual standard error: 0.1368 on 25 degrees of freedom\nMultiple R-squared:  0.7585,    Adjusted R-squared:  0.7199 \nF-statistic: 19.63 on 4 and 25 DF,  p-value: 2.028e-07\n\n\n\n\nVerificar a diferença entre as médias\nUtiliza-se o pacote emmeans\n\nlibrary(emmeans)\n\nmedias1 &lt;- emmeans(m1, ~especie)\n\nlibrary(multcomp)\nlibrary(multcompView) \ncld(medias1)\n\n especie emmean     SE df lower.CL upper.CL .group\n Fgra     0.912 0.0559 25    0.797     1.03  1    \n Faus     1.237 0.0559 25    1.122     1.35   2   \n Fcor     1.322 0.0559 25    1.207     1.44   2   \n Fmer     1.427 0.0559 25    1.312     1.54   23  \n Fasi     1.572 0.0559 25    1.457     1.69    3  \n\nConfidence level used: 0.95 \nP value adjustment: tukey method for comparing a family of 5 estimates \nsignificance level used: alpha = 0.05 \nNOTE: If two or more means share the same grouping symbol,\n      then we cannot show them to be different.\n      But we also did not show them to be the same. \n\n\n\n\nVerificando as Premissas\n\n# Testar normalidade:\nhist(m1$residuals)\n\n\n\nshapiro.test(m1$residuals)\n\n\n    Shapiro-Wilk normality test\n\ndata:  m1$residuals\nW = 0.9821, p-value = 0.8782\n\n# Variâncias:\nbartlett.test(tcm ~especie, data = micelial)\n\n\n    Bartlett test of homogeneity of variances\n\ndata:  tcm by especie\nBartlett's K-squared = 4.4367, df = 4, p-value = 0.3501\n\nlibrary(DHARMa)\nplot(simulateResiduals(m1))\n\n\n\nlibrary(performance)\ncheck_normality(m1)\n\nOK: residuals appear as normally distributed (p = 0.878).\n\ncheck_heteroscedasticity(m1) \n\nOK: Error variance appears to be homoscedastic (p = 0.880).\n\ncheck_model(m1)\n\n\n\n\n\n\nOutro conjunto de dados onde as premissas não foram atendidas:\n\n\nImportação dos dados\n\ninseticida &lt;- InsectSprays\n\ninseticida |&gt; \n  count(spray)\n\n  spray  n\n1     A 12\n2     B 12\n3     C 12\n4     D 12\n5     E 12\n6     F 12\n\ninseticida |&gt; \n  ggplot(aes(spray, count))+\n  geom_boxplot()\n\n\n\n\n\n# lm = ajusta anova\n\nm1 &lt;- lm(count ~ spray,\n         data = inseticida)\n\nsummary(m1)\n\n\nCall:\nlm(formula = count ~ spray, data = inseticida)\n\nResiduals:\n   Min     1Q Median     3Q    Max \n-8.333 -1.958 -0.500  1.667  9.333 \n\nCoefficients:\n            Estimate Std. Error t value Pr(&gt;|t|)    \n(Intercept)  14.5000     1.1322  12.807  &lt; 2e-16 ***\nsprayB        0.8333     1.6011   0.520    0.604    \nsprayC      -12.4167     1.6011  -7.755 7.27e-11 ***\nsprayD       -9.5833     1.6011  -5.985 9.82e-08 ***\nsprayE      -11.0000     1.6011  -6.870 2.75e-09 ***\nsprayF        2.1667     1.6011   1.353    0.181    \n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\nResidual standard error: 3.922 on 66 degrees of freedom\nMultiple R-squared:  0.7244,    Adjusted R-squared:  0.7036 \nF-statistic:  34.7 on 5 and 66 DF,  p-value: &lt; 2.2e-16\n\nanova(m1)\n\nAnalysis of Variance Table\n\nResponse: count\n          Df Sum Sq Mean Sq F value    Pr(&gt;F)    \nspray      5 2668.8  533.77  34.702 &lt; 2.2e-16 ***\nResiduals 66 1015.2   15.38                      \n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\nhist(m1$residuals)\n\n\n\nshapiro.test(m1$residuals)\n\n\n    Shapiro-Wilk normality test\n\ndata:  m1$residuals\nW = 0.96006, p-value = 0.02226\n\nqqnorm(m1$residuals)\nqqline(m1$residuals)\n\n\n\nbartlett.test(count ~ spray,\n             data = inseticida)\n\n\n    Bartlett test of homogeneity of variances\n\ndata:  count by spray\nBartlett's K-squared = 25.96, df = 5, p-value = 9.085e-05\n\n\n\nlibrary(performance)\ncheck_normality(m1)\n\nWarning: Non-normality of residuals detected (p = 0.022).\n\ncheck_heteroscedasticity(m1)\n\nWarning: Heteroscedasticity (non-constant error variance) detected (p &lt; .001).\n\nlibrary(DHARMa)\nplot(simulateResiduals(m1))\n\n\n\n\n\n\n1- Fazer a transformação dos dados\nFunção sqrt faz a raiz quadrada.\n\ninseticida &lt;- inseticida |&gt; \n  mutate(count2 = sqrt(count))\n\ninseticida |&gt; \n  ggplot(aes(spray, count2))+\n  geom_boxplot()\n\n\n\n\n\nm2 &lt;- lm(count2 ~ spray,\n         data = inseticida)\n\nsummary(m2)\n\n\nCall:\nlm(formula = count2 ~ spray, data = inseticida)\n\nResiduals:\n     Min       1Q   Median       3Q      Max \n-1.24486 -0.39970 -0.01902  0.42661  1.40089 \n\nCoefficients:\n            Estimate Std. Error t value Pr(&gt;|t|)    \n(Intercept)   3.7607     0.1814  20.733  &lt; 2e-16 ***\nsprayB        0.1160     0.2565   0.452    0.653    \nsprayC       -2.5158     0.2565  -9.807 1.64e-14 ***\nsprayD       -1.5963     0.2565  -6.223 3.80e-08 ***\nsprayE       -1.9512     0.2565  -7.606 1.34e-10 ***\nsprayF        0.2579     0.2565   1.006    0.318    \n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\nResidual standard error: 0.6283 on 66 degrees of freedom\nMultiple R-squared:  0.7724,    Adjusted R-squared:  0.7552 \nF-statistic:  44.8 on 5 and 66 DF,  p-value: &lt; 2.2e-16\n\nanova(m2)\n\nAnalysis of Variance Table\n\nResponse: count2\n          Df Sum Sq Mean Sq F value    Pr(&gt;F)    \nspray      5 88.438 17.6876  44.799 &lt; 2.2e-16 ***\nResiduals 66 26.058  0.3948                      \n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\nhist(m2$residuals)\n\n\n\nshapiro.test(m2$residuals)  \n\n\n    Shapiro-Wilk normality test\n\ndata:  m2$residuals\nW = 0.98721, p-value = 0.6814\n\nqqnorm(m2$residuals)\nqqline(m2$residuals)\n\n\n\nbartlett.test(count2 ~spray,\n             data = inseticida)  \n\n\n    Bartlett test of homogeneity of variances\n\ndata:  count2 by spray\nBartlett's K-squared = 3.7525, df = 5, p-value = 0.5856\n\n\n\ncheck_normality(m2)\n\nOK: residuals appear as normally distributed (p = 0.681).\n\ncheck_heteroscedasticity(m2)\n\nOK: Error variance appears to be homoscedastic (p = 0.854).\n\nplot(simulateResiduals(m2)) #melhorou ainda mais a normmalidade e variância deu ñ significativo\n\n\n\n\n\nm1_medias &lt;- emmeans(m1, ~ spray,)\nplot(m1_medias)\n\n\n\ncld(m1_medias)\n\n spray emmean   SE df lower.CL upper.CL .group\n C       2.08 1.13 66   -0.177     4.34  1    \n E       3.50 1.13 66    1.240     5.76  1    \n D       4.92 1.13 66    2.656     7.18  1    \n A      14.50 1.13 66   12.240    16.76   2   \n B      15.33 1.13 66   13.073    17.59   2   \n F      16.67 1.13 66   14.406    18.93   2   \n\nConfidence level used: 0.95 \nP value adjustment: tukey method for comparing a family of 6 estimates \nsignificance level used: alpha = 0.05 \nNOTE: If two or more means share the same grouping symbol,\n      then we cannot show them to be different.\n      But we also did not show them to be the same. \n\nm2_medias &lt;- emmeans(m2, ~ spray,)\nplot(m2_medias)\n\n\n\ncld(m2_medias)\n\n spray emmean    SE df lower.CL upper.CL .group\n C       1.24 0.181 66    0.883     1.61  1    \n E       1.81 0.181 66    1.447     2.17  12   \n D       2.16 0.181 66    1.802     2.53   2   \n A       3.76 0.181 66    3.399     4.12    3  \n B       3.88 0.181 66    3.514     4.24    3  \n F       4.02 0.181 66    3.656     4.38    3  \n\nConfidence level used: 0.95 \nP value adjustment: tukey method for comparing a family of 6 estimates \nsignificance level used: alpha = 0.05 \nNOTE: If two or more means share the same grouping symbol,\n      then we cannot show them to be different.\n      But we also did not show them to be the same. \n\npwpm(m2_medias)\n\n       A      B      C      D      E      F\nA [3.76] 0.9975 &lt;.0001 &lt;.0001 &lt;.0001 0.9145\nB -0.116 [3.88] &lt;.0001 &lt;.0001 &lt;.0001 0.9936\nC  2.516  2.632 [1.24] 0.0081 0.2513 &lt;.0001\nD  1.596  1.712 -0.919 [2.16] 0.7366 &lt;.0001\nE  1.951  2.067 -0.565  0.355 [1.81] &lt;.0001\nF -0.258 -0.142 -2.774 -1.854 -2.209 [4.02]\n\nRow and column labels: spray\nUpper triangle: P values   adjust = \"tukey\"\nDiagonal: [Estimates] (emmean) \nLower triangle: Comparisons (estimate)   earlier vs. later\n\npwpp(m2_medias)\n\n\n\npairs(m2_medias)\n\n contrast estimate    SE df t.ratio p.value\n A - B      -0.116 0.257 66  -0.452  0.9975\n A - C       2.516 0.257 66   9.807  &lt;.0001\n A - D       1.596 0.257 66   6.223  &lt;.0001\n A - E       1.951 0.257 66   7.606  &lt;.0001\n A - F      -0.258 0.257 66  -1.006  0.9145\n B - C       2.632 0.257 66  10.259  &lt;.0001\n B - D       1.712 0.257 66   6.675  &lt;.0001\n B - E       2.067 0.257 66   8.058  &lt;.0001\n B - F      -0.142 0.257 66  -0.554  0.9936\n C - D      -0.919 0.257 66  -3.584  0.0081\n C - E      -0.565 0.257 66  -2.201  0.2513\n C - F      -2.774 0.257 66 -10.813  &lt;.0001\n D - E       0.355 0.257 66   1.383  0.7366\n D - F      -1.854 0.257 66  -7.229  &lt;.0001\n E - F      -2.209 0.257 66  -8.612  &lt;.0001\n\nP value adjustment: tukey method for comparing a family of 6 estimates \n\n\n\n\nOutra forma de transformação:\n\nb &lt;- boxcox(lm(inseticida$count+0.1 ~1))\n\n\n\nlambda &lt;- b$x[which.max(b$y)]\n\ninseticida$count3 &lt;- (inseticida$count ^ lambda - 1) / lambda\n\nm5 &lt;- lm(count3 ~ spray,\n         data = inseticida)\n\nsummary(m5)\n\n\nCall:\nlm(formula = count3 ~ spray, data = inseticida)\n\nResiduals:\n     Min       1Q   Median       3Q      Max \n-2.74114 -0.65893 -0.01922  0.78560  2.64047 \n\nCoefficients:\n            Estimate Std. Error t value Pr(&gt;|t|)    \n(Intercept)   4.8835     0.3232  15.109  &lt; 2e-16 ***\nsprayB        0.1910     0.4571   0.418    0.677    \nsprayC       -4.4995     0.4571  -9.843 1.42e-14 ***\nsprayD       -2.7157     0.4571  -5.941 1.17e-07 ***\nsprayE       -3.3605     0.4571  -7.352 3.82e-10 ***\nsprayF        0.4162     0.4571   0.911    0.366    \n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\nResidual standard error: 1.12 on 66 degrees of freedom\nMultiple R-squared:  0.7659,    Adjusted R-squared:  0.7482 \nF-statistic: 43.19 on 5 and 66 DF,  p-value: &lt; 2.2e-16\n\nanova(m5)\n\nAnalysis of Variance Table\n\nResponse: count3\n          Df  Sum Sq Mean Sq F value    Pr(&gt;F)    \nspray      5 270.737  54.147  43.191 &lt; 2.2e-16 ***\nResiduals 66  82.742   1.254                      \n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\nhist(m5$residuals)\n\n\n\nshapiro.test(m5$residuals)  \n\n\n    Shapiro-Wilk normality test\n\ndata:  m5$residuals\nW = 0.98873, p-value = 0.7723\n\nqqnorm(m5$residuals)\nqqline(m5$residuals)\n\n\n\nbartlett.test(count3 ~spray,\n             data = inseticida)\n\n\n    Bartlett test of homogeneity of variances\n\ndata:  count3 by spray\nBartlett's K-squared = 5.7412, df = 5, p-value = 0.3322\n\n\n\n\n2- teste não paramétrico:\n\nkruskal.test(count ~spray,\n             data = inseticida) \n\n\n    Kruskal-Wallis rank sum test\n\ndata:  count by spray\nKruskal-Wallis chi-squared = 54.691, df = 5, p-value = 1.511e-10\n\nm3 &lt;- kruskal(inseticida$count,\n        inseticida$spray,\n        group = TRUE)\n\n\n\n3- GLMs\n\nm4 &lt;- glm(count ~ spray,\n          family = gaussian,\n          data = inseticida)\n\n\nm4 &lt;- glm(count ~ spray,\n          family = poisson,\n          data = inseticida)\nsummary(m4)\n\n\nCall:\nglm(formula = count ~ spray, family = poisson, data = inseticida)\n\nCoefficients:\n            Estimate Std. Error z value Pr(&gt;|z|)    \n(Intercept)  2.67415    0.07581  35.274  &lt; 2e-16 ***\nsprayB       0.05588    0.10574   0.528    0.597    \nsprayC      -1.94018    0.21389  -9.071  &lt; 2e-16 ***\nsprayD      -1.08152    0.15065  -7.179 7.03e-13 ***\nsprayE      -1.42139    0.17192  -8.268  &lt; 2e-16 ***\nsprayF       0.13926    0.10367   1.343    0.179    \n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\n(Dispersion parameter for poisson family taken to be 1)\n\n    Null deviance: 409.041  on 71  degrees of freedom\nResidual deviance:  98.329  on 66  degrees of freedom\nAIC: 376.59\n\nNumber of Fisher Scoring iterations: 5\n\nanova(m4)\n\nAnalysis of Deviance Table\n\nModel: poisson, link: log\n\nResponse: count\n\nTerms added sequentially (first to last)\n\n      Df Deviance Resid. Df Resid. Dev\nNULL                     71     409.04\nspray  5   310.71        66      98.33\n\nAnova(m4)\n\nAnalysis of Deviance Table (Type II tests)\n\nResponse: count\n      LR Chisq Df Pr(&gt;Chisq)    \nspray   310.71  5  &lt; 2.2e-16 ***\n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\nplot(simulateResiduals(m4))\n\n\n\nm4_medias &lt;- emmeans(m4, ~spray,\n                     type = \"response\")\n\ncld(m4_medias)\n\n spray  rate    SE  df asymp.LCL asymp.UCL .group\n C      2.08 0.417 Inf      1.41      3.08  1    \n E      3.50 0.540 Inf      2.59      4.74  12   \n D      4.92 0.640 Inf      3.81      6.35   2   \n A     14.50 1.099 Inf     12.50     16.82    3  \n B     15.33 1.130 Inf     13.27     17.72    3  \n F     16.67 1.179 Inf     14.51     19.14    3  \n\nConfidence level used: 0.95 \nIntervals are back-transformed from the log scale \nP value adjustment: tukey method for comparing a family of 6 estimates \nTests are performed on the log scale \nsignificance level used: alpha = 0.05 \nNOTE: If two or more means share the same grouping symbol,\n      then we cannot show them to be different.\n      But we also did not show them to be the same."
  },
  {
    "objectID": "testet.html#anova-2-fatores",
    "href": "testet.html#anova-2-fatores",
    "title": "FIP606",
    "section": "Anova 2 fatores",
    "text": "Anova 2 fatores\n\nModelo fatorial"
  },
  {
    "objectID": "testet.html#importa-os-dados",
    "href": "testet.html#importa-os-dados",
    "title": "FIP606",
    "section": "Importa os dados",
    "text": "Importa os dados\n\ntheme_set(theme_bw())\nli &lt;- gsheet2tbl(\"https://docs.google.com/spreadsheets/d/1bq2N19DcZdtax2fQW9OHSGMR0X2__Z9T/edit#gid=2023059672\")\n\n\nli |&gt; \n  ggplot(aes(factor(dose), severity, color = factor(dose)))+\n  geom_jitter(width = 0.05)+\n  facet_wrap(~~treat)\n\n\n\nli |&gt; \n  ggplot(aes(factor(treat), severity, color = factor(dose)))+\n  geom_jitter(width = 0.05)\n\n\n\n\n\nAnova\n\nmf &lt;- lm(severity ~treat*factor(dose),\n         data = li)\n\nanova(mf)\n\nAnalysis of Variance Table\n\nResponse: severity\n                   Df   Sum Sq  Mean Sq F value    Pr(&gt;F)    \ntreat               1 0.113232 0.113232  30.358 4.754e-05 ***\nfactor(dose)        1 0.073683 0.073683  19.755 0.0004077 ***\ntreat:factor(dose)  1 0.072739 0.072739  19.502 0.0004326 ***\nResiduals          16 0.059678 0.003730                      \n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\n\n\n\nTestar as premissas\n\nplot(simulateResiduals(mf))\n\n\n\n\n\n\nComparar colunas\n\nmf_medias &lt;- emmeans(mf, ~ treat | dose)\ncld(mf_medias) \n\ndose = 0.5:\n treat        emmean     SE df lower.CL upper.CL .group\n Tebuconazole 0.0210 0.0273 16 -0.03690   0.0789  1    \n Ionic liquid 0.2921 0.0273 16  0.23420   0.3500   2   \n\ndose = 2.0:\n treat        emmean     SE df lower.CL upper.CL .group\n Tebuconazole 0.0202 0.0273 16 -0.03768   0.0781  1    \n Ionic liquid 0.0501 0.0273 16 -0.00781   0.1080  1    \n\nConfidence level used: 0.95 \nsignificance level used: alpha = 0.05 \nNOTE: If two or more means share the same grouping symbol,\n      then we cannot show them to be different.\n      But we also did not show them to be the same. \n\n\n\n\nComparar linhas\n\nmf_medias &lt;- emmeans(mf, ~ dose | treat)\ncld(mf_medias)\n\ntreat = Ionic liquid:\n dose emmean     SE df lower.CL upper.CL .group\n  2.0 0.0501 0.0273 16 -0.00781   0.1080  1    \n  0.5 0.2921 0.0273 16  0.23420   0.3500   2   \n\ntreat = Tebuconazole:\n dose emmean     SE df lower.CL upper.CL .group\n  2.0 0.0202 0.0273 16 -0.03768   0.0781  1    \n  0.5 0.0210 0.0273 16 -0.03690   0.0789  1    \n\nConfidence level used: 0.95 \nsignificance level used: alpha = 0.05 \nNOTE: If two or more means share the same grouping symbol,\n      then we cannot show them to be different.\n      But we also did not show them to be the same."
  },
  {
    "objectID": "index.html",
    "href": "index.html",
    "title": "Seja bem-vindo ao meu website",
    "section": "",
    "text": "Seja bem-vindo ao meu website\n\n\n\n\n\n\nEu sou Isabela Grossi doutoranda do programa de pós-graduação em Fitopatologia da Universidade Federal de Viçosa - UFV. Finalizei o mestrado em Fitopatologia (2024) pela Universidade Federal de Viçosa - UFV. Possuo graduação em Agronomia com formação pelo IF Sudeste MG - campus Barbacena e Técnica em Floresta pelo IF Sudeste MG - campus Rio Pomba.\nEste website foi criando com o objetivo de disponibilizar as aulas que foram ministrada na disciplina FIP606 - Análise e visualização de dados em Fitopatologia, ministrada pelo professor Emerson Del Ponte.\nConvido você a explorar o meu site e aproveitar o conteúdo disponibilizado!!"
  },
  {
    "objectID": "graficos1.html",
    "href": "graficos1.html",
    "title": "FIP606",
    "section": "",
    "text": "library(tidyverse)\n\ncr &lt;- read_csv(\"https://raw.githubusercontent.com/emdelponte/paper-coffee-rust-Ethiopia/master/data/survey_clean.csv\")\n\nglimpse(cr)\n\nRows: 405\nColumns: 13\n$ farm            &lt;dbl&gt; 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16,…\n$ region          &lt;chr&gt; \"SNNPR\", \"SNNPR\", \"SNNPR\", \"SNNPR\", \"SNNPR\", \"SNNPR\", …\n$ zone            &lt;chr&gt; \"Bench Maji\", \"Bench Maji\", \"Bench Maji\", \"Bench Maji\"…\n$ district        &lt;chr&gt; \"Debub Bench\", \"Debub Bench\", \"Debub Bench\", \"Debub Be…\n$ lon             &lt;dbl&gt; 35.44250, 35.44250, 35.42861, 35.42861, 35.42861, 35.3…\n$ lat             &lt;dbl&gt; 6.904722, 6.904722, 6.904444, 6.904444, 6.904444, 6.90…\n$ altitude        &lt;dbl&gt; 1100, 1342, 1434, 1100, 1400, 1342, 1432, 1100, 1400, …\n$ cultivar        &lt;chr&gt; \"Local\", \"Mixture\", \"Mixture\", \"Local\", \"Local\", \"Mixt…\n$ shade           &lt;chr&gt; \"Sun\", \"Mid shade\", \"Mid shade\", \"Sun\", \"Sun\", \"Mid sh…\n$ cropping_system &lt;chr&gt; \"Plantation\", \"Plantation\", \"Plantation\", \"Plantation\"…\n$ farm_management &lt;chr&gt; \"Unmanaged\", \"Minimal\", \"Minimal\", \"Unmanaged\", \"Unman…\n$ inc             &lt;dbl&gt; 86.70805, 51.34354, 43.20000, 76.70805, 47.15808, 51.3…\n$ sev2            &lt;dbl&gt; 55.57986, 17.90349, 8.25120, 46.10154, 12.25167, 19.91…"
  },
  {
    "objectID": "graficos1.html#diferentes-tipos-e-customização-de-gráficos-para-visualização-dos-dados",
    "href": "graficos1.html#diferentes-tipos-e-customização-de-gráficos-para-visualização-dos-dados",
    "title": "FIP606",
    "section": "Diferentes tipos e customização de gráficos para visualização dos dados:",
    "text": "Diferentes tipos e customização de gráficos para visualização dos dados:\n\n1- Gráficos em barras:\n\ncr %&gt;%\n  count(zone, shade) %&gt;% \n  arrange(- n) %&gt;% \n  ggplot(aes(zone, n, fill = shade)) +\n  geom_col()\n\n\n\n\n-&gt; Costumizando o ggplot anterior:\n1º Evitar a sobreposição dos nomes: inverte as barras de vertical para horizontal, utilizando a função coord_flip().\n\ncr %&gt;%\n  count(zone, shade) %&gt;% \n  arrange(- n) %&gt;% \n  ggplot(aes(zone, n, fill = shade)) +\n  geom_col()+\n  coord_flip()\n\n\n\n\n- Customizando o gráfico:\nPara tirar no eixo x o escrito zone: labs(x= \"\")\nTítulo do gráfico: title= \"XXX\".\nColocar uma fonte: caption = \"XXX\".\nTrocar o titulo da legenda: Fiil = \"XXX\".\nA escala de cor que estamos usando aqui é do sombreamento.\n\ncr %&gt;%\n  count(zone, shade) %&gt;% \n  arrange(- n) %&gt;% \n  ggplot(aes(zone, n, fill = shade)) +\n  geom_col()+\n  coord_flip() +\n  labs(x= \"\", y = \"Número de fazendas\", title = \"Ferrugem do café na Etiópia\", caption = \"Belachew et al. (2020)\", fill = \"Levels of shade\") +\n  scale_y_continuous(limits = c(0,80), n.breaks = 6)\n\n\n\n\n-&gt; Colocar as barras do gráfico em preto e branco :\n\ncr %&gt;%\n  count(zone, shade) %&gt;% \n  arrange(- n) %&gt;% \n  ggplot(aes(zone, n, fill = shade)) +\n  geom_col()+\n  coord_flip() +\n  labs(x= \"\", y = \"Número de fazendas\", title = \"Ferrugem do café na Etiópia\", caption = \"Belachew et al. (2020)\", fill = \"Levels of shade\") +\n  scale_y_continuous(limits = c(0,80), n.breaks = 6) +\n  scale_fill_grey()\n\n\n\n\n-&gt; Tirando o tema cinza no fundo.\ncowplot - tem alguns temas diferentes.\n\nlibrary(cowplot)\n\ncr %&gt;%\n  count(zone, shade) %&gt;% \n  arrange(- n) %&gt;% \n  ggplot(aes(zone, n, fill = shade)) +\n  geom_col()+\n  coord_flip() +\n  labs(x= \"\", y = \"Número de fazendas\", title = \"Ferrugem do café na Etiópia\", caption = \"Belachew et al. (2020)\", fill = \"Levels of shade\") +\n  scale_y_continuous(limits = c(0,80), n.breaks = 6) +\n  scale_fill_grey() +\n  theme_half_open(font_size = 12) \n\n\n\n\n-&gt; Reposicionar a legenda e colocar em outra posição:\n\ncr %&gt;%\n  count(zone, shade) %&gt;% \n  arrange(- n) %&gt;% \n  ggplot(aes(zone, n, fill = shade)) +\n  geom_col()+\n  coord_flip() +\n  labs(x= \"\", y = \"Número de fazendas\", title = \"Ferrugem do café na Etiópia\", caption = \"Belachew et al. (2020)\", fill = \"Levels of shade\") +\n  scale_y_continuous(limits = c(0,80), n.breaks = 6) +\n  scale_fill_grey() +\n  theme_half_open(font_size = 12) +\n  theme(legend.position = \"bottom\" )\n\n\n\n\n-&gt; Para colocar as barras do gráfico encostado no eixo y:\nColoca : expand = c(0,0) em scale_y_continuous()\n\ncr %&gt;%\n  count(zone, shade) %&gt;% \n  arrange(- n) %&gt;% \n  ggplot(aes(zone, n, fill = shade)) +\n  geom_col()+\n  coord_flip() +\n  labs(x= \"\", y = \"Número de fazendas\", title = \"Ferrugem do café na Etiópia\", caption = \"Belachew et al. (2020)\", fill = \"Levels of shade\") +\n  scale_y_continuous(expand = c(0,0),\n                     limits = c(0,80), \n                     n.breaks = 6) +\n  scale_fill_grey() +\n  theme_half_open(font_size = 12) +\n  theme(legend.position = \"bottom\" )\n\n\n\n\n\n\n2- Gráfico de Histograma\nOutro tipo de gráfico utilizando uma variavel continua.\n\nQuero fazer um histograma de frequencia e incidencia ou severidade.\n\n\ncr %&gt;% \n  ggplot(aes(x= inc)) +\n  geom_histogram()\n\n\n\n\n-&gt; definindo a quantidade de barras dentro do histograma\n\ncr %&gt;% \n  ggplot(aes(x= inc)) +\n  geom_histogram(bins = 10)\n\n\n\n\nAparecer barrinhas individuais:\n\ncr %&gt;% \n  ggplot(aes(x= inc)) +\n  geom_histogram(bins = 10, \n                 color = \"white\")\n\n\n\n\n-&gt; Preenchimento diferente de cinza:\n\ncr %&gt;% \n  ggplot(aes(x= inc)) +\n  geom_histogram(bins = 10, \n                 color = \"white\",\n                 fill = \"darkmagenta\")\n\n\n\n\n-&gt; Vamos fazer um gráfico para cada tipo de sombreamento\n\nPainel da distribuição por sombremaento. Função: facet_wrap\n\nSerá que existe dirença na distribuição da incidencia de acordo com a caracteristica de sombreamento de cada fazenda.\n\ncr %&gt;% \n  ggplot(aes(x= inc)) +\n  geom_histogram(bins = 10, \n                 color = \"white\",\n                 fill = \"darkmagenta\") +\n  facet_wrap(~ shade)\n\n\n\n\nOBS: Na situação de sombreamento “SUN” tem uma incidencia mais alta.\nO “FULL SHADE”, quer dizer que o café cultivado na sombra tem menos ferrugem. E o café cultivado a ceu aberto “SUN”, tende a ter mais incidencia de ferrugem.\n-&gt; Agora quero ver severidade.\n\ncr %&gt;% \n  ggplot(aes(x= sev2)) +\n  geom_histogram(bins = 10, \n                 color = \"white\",\n                 fill = \"darkmagenta\") +\n  facet_wrap(~ shade)\n\n\n\n\n–&gt; Quero saber agora se tem efeito de cultivar:\n\ncr %&gt;% \n  ggplot(aes(x= sev2)) +\n  geom_histogram(bins = 10, \n                 color = \"white\",\n                 fill = \"darkmagenta\") +\n  facet_wrap(~ cultivar)\n\n\n\n\nOBS: a cultivar local tende a ter maior severidade porque também são cultivadas a céu aberto.\n\n\n3- Boxplot\n\ncr %&gt;% \n  ggplot(aes(cultivar, sev2)) +\n  geom_boxplot()\n\n\n\n\n–&gt; Fazendo agora por região\n\ncr %&gt;% \n  ggplot(aes(cultivar, sev2)) +\n  geom_boxplot() +\n  facet_wrap(~ region)\n\n\n\n\nOBS: Não tem efeito de região. Não tem efeito na severidade nas diferentes cultivares nas duas regiões analisadas.\n–&gt; facet_wrap que combina duas colunas\n\ncr %&gt;% \n  ggplot(aes(shade, sev2)) +\n  geom_boxplot() +\n  facet_wrap(region ~ zone)\n\n\n\n\n–&gt; Facet_grid\n\ncr %&gt;% \n  ggplot(aes(shade, sev2)) +\n  geom_boxplot() +\n  facet_grid(region ~ zone)\n\n\n\n\nOBS:Então nos vimos como fazer um histograma para uma variavel continua e como quebrar os gráficos fazendo um painel facet_wrap\n\n\n4- Gráfico de dispersão de pontos.\n–&gt; Pergunta a ser respondida: existe relação entre a incidência e a severidade (duas variaveis continuas)?\n\ncr %&gt;%\n  ggplot(aes(inc, sev2)) +\n  geom_point()\n\n\n\n\n–&gt; Outra pergunta: existe algum fator que afeta essa relação, por exemplo a cultivar\n\n# \"~\" é a condição.  \n\ncr %&gt;%\n  ggplot(aes(inc, sev2)) +\n  geom_point() +\n  facet_wrap(~ cultivar)\n\n\n\n\n–&gt; Customização deste plot:\n\nlibrary(cowplot)\n\ncr %&gt;%\n  ggplot(aes(inc, sev2)) +\n  geom_point() +\n  theme_cowplot() +\n  labs(y = \"Severity (%)\", x = \"Incidence (%)\")\n\n\n\n\n–&gt; Quero colocar uma anotação neste gráfico:\nDe maneira hipotetica.\nColocar uma camada de anotação em cima do gráfico com o valor da correlação calculada a baixo. Com a função annotate\nCalculando a correlação:\n\ncor(cr$inc, cr$sev2)\n\n[1] 0.883102\n\n\nPara fazer anotação no plot- label = \"R = 0,88 P &lt; 0.01\n\ncr %&gt;%\n  ggplot(aes(inc, sev2)) +\n  geom_point() +\n  theme_cowplot() +\n  labs(y = \"Severity (%)\", x = \"Incidence (%)\") +\n  annotate(geom = \"text\",\n           x = 20,\n           y = 50,\n           label = \"R = 0,88 P &lt; 0.01\")\n\n\n\n\n\nPara salvar esse gráfico para utilizar no artigo\n\ncr %&gt;%\n  ggplot(aes(inc, sev2)) +\n  geom_point() +\n  theme_cowplot() +\n  labs(y = \"Severity (%)\", x = \"Incidence (%)\") +\n  annotate(geom = \"text\",\n           x = 20,\n           y = 50,\n           label = \"R = 0,88\nP &lt; 0.01\")\n\n\n\nggsave(\"plot2.png\")   # Fazendo desta forma ele salva com o fundo cinza.\n\n# bg- muda a cor de fundo.\n\nggsave(\"plot2.png\", bg = \"white\", dpi = 600)\n\n\n# Tamanho da imagem\n\nggsave(\"plot2.png\", bg = \"white\", dpi = 600,\n       width = 6, height = 6)\n\n–&gt; Modificando as fontes:\nDependo do tema, aceita-se mudar atraves da função font_family().\n\ncr %&gt;%\n  ggplot(aes(inc, sev2)) +\n  geom_point() +\n  theme_cowplot(font_family = \"times\") +\n  labs(y = \"Severity (%)\", x = \"Incidence (%)\") +\n  annotate(geom = \"text\",\n           x = 20,\n           y = 50,\n           label = \"R = 0,88\nP &lt; 0.01\")\n\n\n\n# outro tipo de tema que aceita mudar fonte.\n\ncr %&gt;%\n  ggplot(aes(inc, sev2)) +\n  geom_point() +\n  theme_minimal_grid(font_family = \"times\") +\n  labs(y = \"Severity (%)\", x = \"Incidence (%)\") +\n  annotate(geom = \"text\",\n           x = 20,\n           y = 50,\n           label = \"R = 0,88\nP &lt; 0.01\")\n\n\n\n\n–&gt; Colocando limite de valores no eixo x e eixo y:\n\ncr %&gt;%\n  ggplot(aes(inc, sev2)) +\n  geom_point() +\n  theme_cowplot(font_family = \"times\") +\n  labs(y = \"Severity (%)\", x = \"Incidence (%)\") +\n  annotate(geom = \"text\",\n           x = 20,\n           y = 50,\n           label = \"R = 0,88\nP &lt; 0.01\") +\n  ylim(0,100) +\n  xlim(0,100)\n\n\n\n\n–&gt; Mudar a cor dos pontos de acordo com a cultivar:\nMudamos na aes\n\ncr %&gt;%\n  ggplot(aes(inc, sev2, color = cultivar)) +\n  geom_point() +\n  theme_cowplot(font_family = \"Times\") +\n  labs(y = \"Severity (%)\", x = \"Incidence (%)\") +\n  annotate(geom = \"text\",\n           x = 20,\n           y = 50,\n           label = \"R = 0,88\nP &lt; 0.01\") +\n  ylim(0,100) +\n  xlim(0,100)\n\n\n\n\n–&gt; Mudar a posição da legenda:\n\ncr %&gt;%\n  ggplot(aes(inc, sev2, color = cultivar)) +\n  geom_point() +\n  theme_cowplot(font_family = \"Times\") +\n  labs(y = \"Severity (%)\", x = \"Incidence (%)\") +\n  annotate(geom = \"text\",\n           x = 20,\n           y = 50,\n           label = \"R = 0,88\nP &lt; 0.01\") +\n  ylim(0,100) +\n  xlim(0,100) +\n  theme(legend.position = \"top\")\n\n\n\n\n–&gt; Mudar o tamanho dos elementos no cowplot\n\ncr %&gt;%\n  ggplot(aes(inc, sev2, color = cultivar)) +\n  geom_point() +\n  theme_cowplot(font_family = \"Times\",\n                font_size = 10) +\n  labs(y = \"Severity (%)\", x = \"Incidence (%)\", title = \"\", color = \"Cultivar\") +\n  annotate(geom = \"text\",\n           x = 20,\n           y = 50,\n           label = \"R = 0,88\nP &lt; 0.01\") +\n  ylim(0,100) +\n  xlim(0,100) +\n  theme(legend.position = \"top\")\n\n\n\n\n–&gt; Mudar a escala de cores\nPodemos colocar manual scale_color_manual() igual feito abaixo ou colocar uma paleta pronta.\n\ncr %&gt;%\n  ggplot(aes(inc, sev2, color = cultivar)) +\n  geom_point() +\n  theme_cowplot(font_family = \"Times\",\n                font_size = 10) +\n  labs(y = \"Severity (%)\", x = \"Incidence (%)\", title = \"\", color = \"Cultivar\") +\n  annotate(geom = \"text\",\n           x = 20,\n           y = 50,\n           label = \"R = 0,88\nP &lt; 0.01\") +\n  ylim(0,100) +\n  xlim(0,100) +\n  theme(legend.position = \"top\") +\n  scale_color_manual(values = c(\"steelblue\",\n                                \"darkorange\",\n                                \"black\"))\n\n\n\n\nObs: ggthemes- além de dar vários temas diferentes, ele trás também várias paletas de cores.\n\nlibrary(ggthemes)\n\ncr %&gt;%\n  ggplot(aes(inc, sev2, color = cultivar)) +\n  geom_point() + \n  theme_few() +\n  labs(y = \"Severity (%)\", x = \"Incidence (%)\", title = \"\", color = \"Cultivar\") +\n  annotate(geom = \"text\",\n           x = 20,\n           y = 50,\n           label = \"R = 0,88\nP &lt; 0.01\") +\n  ylim(0,100) +\n  xlim(0,100) +\n  theme(legend.position = \"top\") +\n  scale_color_colorblind()"
  },
  {
    "objectID": "correlacao.html",
    "href": "correlacao.html",
    "title": "FIP606",
    "section": "",
    "text": "library(gsheet)\nlibrary(tidyverse)\nlibrary(AgroR)\nlibrary(dplyr)\nlibrary(corrplot)\n\n\n\n\n\nimagem &lt;- gsheet2tbl(\"https://docs.google.com/spreadsheets/d/1bq2N19DcZdtax2fQW9OHSGMR0X2__Z9T/edit#gid=373270992\")\n\n\n\n\n\nimagem |&gt; \n  ggplot(aes(Assess, LeafDoctor))+\n  geom_point()\n\n\n\nimagem |&gt; \n  pivot_longer(3:5, names_to = \"method\", values_to = \"value\") |&gt; \n  ggplot(aes(method, value))+\n  geom_boxplot()\n\n\n\nimagem |&gt; \nggplot(aes(Assess, ImageJ))+\n  geom_point()+\n  geom_smooth(method = \"ln\")\n\n\n\nimagem |&gt; \nggplot(aes(Assess, LeafDoctor))+\n  geom_point()+\n  geom_smooth(method = \"ln\")\n\n\n\n\n\n\n\n\nimagem2 &lt;- imagem |&gt; \n  dplyr::select(3:5)\ncorgraph(imagem2)\n\n        Var1       Var2       cor            p\n2 LeafDoctor     Assess 0.9666367 5.972544e-42\n3     ImageJ     Assess 0.9776918 8.143613e-48\n6     ImageJ LeafDoctor 0.9797478 3.144091e-49\n\n\n\n\ncor.test(imagem$Assess, imagem$LeafDoctor)\n\n\n    Pearson's product-moment correlation\n\ndata:  imagem$Assess and imagem$LeafDoctor\nt = 31.119, df = 68, p-value &lt; 2.2e-16\nalternative hypothesis: true correlation is not equal to 0\n95 percent confidence interval:\n 0.9466882 0.9792005\nsample estimates:\n      cor \n0.9666367 \n\ncor(imagem$Assess, imagem$LeafDoctor)\n\n[1] 0.9666367\n\n\n\n\n\n\ncor_imagem2 &lt;- cor(imagem2)\ncorrplot(cor_imagem2, method = 'number', type = \"lower\")\n\n\n\ncorrplot(cor_imagem2, method = 'number', type = \"upper\", diag = F)\n\n\n\n\n\n\n\n\ncampo &lt;- gsheet2tbl(\"https://docs.google.com/spreadsheets/d/1bq2N19DcZdtax2fQW9OHSGMR0X2__Z9T/edit#gid=866852711\")\n\n\ncampo2 &lt;- campo |&gt; \ndplyr::select(3:5)\ncorgraph(campo2)\n\n  Var1 Var2        cor            p\n2  FER  DFC  0.9316978 9.864101e-15\n3 PROD  DFC -0.6928161 1.110652e-05\n6 PROD  FER -0.6258321 1.277444e-04\n\n\n\n\n\n\ncampo |&gt; \n  ggplot(aes(FER, PROD))+\n  geom_point()"
  },
  {
    "objectID": "correlacao.html#correlação",
    "href": "correlacao.html#correlação",
    "title": "FIP606",
    "section": "",
    "text": "library(gsheet)\nlibrary(tidyverse)\nlibrary(AgroR)\nlibrary(dplyr)\nlibrary(corrplot)\n\n\n\n\n\nimagem &lt;- gsheet2tbl(\"https://docs.google.com/spreadsheets/d/1bq2N19DcZdtax2fQW9OHSGMR0X2__Z9T/edit#gid=373270992\")\n\n\n\n\n\nimagem |&gt; \n  ggplot(aes(Assess, LeafDoctor))+\n  geom_point()\n\n\n\nimagem |&gt; \n  pivot_longer(3:5, names_to = \"method\", values_to = \"value\") |&gt; \n  ggplot(aes(method, value))+\n  geom_boxplot()\n\n\n\nimagem |&gt; \nggplot(aes(Assess, ImageJ))+\n  geom_point()+\n  geom_smooth(method = \"ln\")\n\n\n\nimagem |&gt; \nggplot(aes(Assess, LeafDoctor))+\n  geom_point()+\n  geom_smooth(method = \"ln\")\n\n\n\n\n\n\n\n\nimagem2 &lt;- imagem |&gt; \n  dplyr::select(3:5)\ncorgraph(imagem2)\n\n        Var1       Var2       cor            p\n2 LeafDoctor     Assess 0.9666367 5.972544e-42\n3     ImageJ     Assess 0.9776918 8.143613e-48\n6     ImageJ LeafDoctor 0.9797478 3.144091e-49\n\n\n\n\ncor.test(imagem$Assess, imagem$LeafDoctor)\n\n\n    Pearson's product-moment correlation\n\ndata:  imagem$Assess and imagem$LeafDoctor\nt = 31.119, df = 68, p-value &lt; 2.2e-16\nalternative hypothesis: true correlation is not equal to 0\n95 percent confidence interval:\n 0.9466882 0.9792005\nsample estimates:\n      cor \n0.9666367 \n\ncor(imagem$Assess, imagem$LeafDoctor)\n\n[1] 0.9666367\n\n\n\n\n\n\ncor_imagem2 &lt;- cor(imagem2)\ncorrplot(cor_imagem2, method = 'number', type = \"lower\")\n\n\n\ncorrplot(cor_imagem2, method = 'number', type = \"upper\", diag = F)\n\n\n\n\n\n\n\n\ncampo &lt;- gsheet2tbl(\"https://docs.google.com/spreadsheets/d/1bq2N19DcZdtax2fQW9OHSGMR0X2__Z9T/edit#gid=866852711\")\n\n\ncampo2 &lt;- campo |&gt; \ndplyr::select(3:5)\ncorgraph(campo2)\n\n  Var1 Var2        cor            p\n2  FER  DFC  0.9316978 9.864101e-15\n3 PROD  DFC -0.6928161 1.110652e-05\n6 PROD  FER -0.6258321 1.277444e-04\n\n\n\n\n\n\ncampo |&gt; \n  ggplot(aes(FER, PROD))+\n  geom_point()"
  },
  {
    "objectID": "aula11.html",
    "href": "aula11.html",
    "title": "Colocar a rosa dos ventos",
    "section": "",
    "text": "Instalando pacote do github e carregando pacotes\n\nlibrary(rnaturalearth)\nlibrary(remotes)\nlibrary(tidyverse)\nlibrary(r4pde)\nlibrary(ggthemes)\nlibrary(ggspatial)\n\nremotes::install_github(\"ropensci/rnaturalearthhires\")\n\n\n\nMapa do Brasil\nPara plotar o mapa do pais, usa-se a função “ne_countries”\n\nBRA &lt;- ne_states(country = \"Brazil\",\n                 returnclass = \"sf\")\n\nworld &lt;- ne_countries()\n\n#library(tidyverse)\nggplot(BRA) +\n  geom_sf(fill = \"white\")\n\n\n\nggplot(BRA) +\n  geom_sf(fill = \"black\",\n          color = \"yellow\",\n          linewidth =0.3)\n\n\n\n\n\n\nMapa do Peru\n\nBRA &lt;- ne_states(country = \"Peru\",\n                 returnclass = \"sf\")\n\nworld &lt;- ne_countries()\n\n#library(tidyverse)\nggplot(BRA) +\n  geom_sf(fill = \"white\")\n\n\n\n\n\n\nMapa da Colombia\n\nBRA &lt;- ne_states(country = \"Colombia\",\n                 returnclass = \"sf\")\n\nworld &lt;- ne_countries()\n\n#library(tidyverse)\nggplot(BRA) +\n  geom_sf(fill = \"white\")\n\n\n\n\n\nBRA &lt;- ne_states(country = \"Brazil\",\n                 returnclas = \"sf\")\n\n\nBRA1 &lt;- ne_countries(country = \"Brazil\",\n                 returnclas = \"sf\")\n\nwordd &lt;- ne_countries()\n\nggplot(BRA1) +\n  geom_sf(fill = \"white\")\n\n\n\n\n\n\nCarregando o conjunto de dados e plotando no mapa\n\n#library(r4pde)\n\nsbr &lt;- RustSoybean\n\n\nsbr |&gt; \n  ggplot(aes(longitude, latitude)) +\n  geom_point() +\n  coord_sf()\n\n\n\n# juntar a camada de ponto e sobrepor o mapa\n\n\n#library(ggthemes)\n\nBRA &lt;- ne_states(country = \"Brazil\",\n                 returnclass = \"sf\")\n\nworld &lt;- ne_countries()\n\n#library(tidyverse)\nggplot(BRA) +\n  geom_sf(fill = \"white\")\n\n\n\nggplot(BRA) +\n  geom_sf(fill = \"black\",\n          color = \"yellow\",\n          linewidth =0.3) +\n  geom_point(data = sbr, aes(longitude, latitude),\n             color = \"white\") +\n  theme_map()\n\n\n\n\n\n\nDestacando o estado de Minas Gerais (MG)\n\nBRA &lt;- ne_states(country = \"Brazil\",\n                 returnclass = \"sf\")\n\nMG &lt;- BRA |&gt; \n  filter(name_en == \"Minas Gerais\")\n\nggplot(BRA) +\n  geom_sf(fill = \"white\")\n\n\n\nggplot(BRA) +\n  geom_sf(fill = \"black\",\n          color = \"yellow\",\n          linewidth =1) +\n  geom_sf(data = MG, fill = \"white\") +\n  geom_point(data = sbr, aes(longitude, latitude),\n             color = \"red\") +\n  theme_map()\n\n\n\n\n\n\nMostrar apenas MG\n\nggplot(BRA)  +\n  geom_sf(data = MG, fill = \"white\") +\n # geom_point(data = sbr, aes(longitude, latitude),\n            # color = \"red\") +\n  theme_map()\n\n\n\n\n\n\nColocar a rosa dos ventos\n\n#library(ggspatial)\n\nggplot(BRA) +\n  geom_sf(fill = \"white\")\n\n\n\nggplot(BRA) +\n  geom_sf(fill = \"black\",\n          color = \"white\",\n          linewidth = 0.3) +\n # geom_sf(data = MG, fill = \"white\") +\n  geom_point(data = sbr, aes(longitude, latitude),\n             color = \"white\") +\n  theme_map() +\n  annotation_north_arrow(which_north = \"grid\")\n\n\n\n\n\nMapas interativos\n\nbra &lt;-ggplot(BRA) +\n  geom_sf(fill = \"black\",\n          color = \"white\",\n          linewidth = 0.3) +\n geom_sf(data = MG, fill = \"black\") +\n  geom_point(data = sbr, aes(longitude, latitude),\n             color = \"white\") +\n  theme_map() +\n  annotation_north_arrow(which_north = \"grid\")\n\nlibrary(plotly)\nggplotly(bra)\n\n\n\n\n\n\nViçosa- MG\n\nlibrary(leaflet)\nleaflet() |&gt; \n  addTiles() |&gt; \n  setView(lng = -42.8825 , lat = -20.7546, zoom = 15)\n\n\n\n\n\n\nlibrary(leaflet)\nleaflet() |&gt; \n  addProviderTiles(providers$Esri.NatGeoWorldMap) |&gt; \n  setView(lng = -42.8825 , lat = -20.7546, zoom = 5)\n\n\n\n\n\n\n\nAdicionando os pontos\n\nlibrary(leaflet)\nleaflet(sbr) |&gt; \n  addTiles() |&gt; \n  #setView(lng = -42.8825 , lat = -20.7546, zoom = 5) |&gt; \n  addCircleMarkers(radius = 2)\n\n\n\n\n\n\n\n\nColocando grafico de pizza no mapa\nA tabela tem que estar em formato largo.\n\nCarrega o conjunto de dados;\ncria um mapa\n\n\nBRA &lt;- ne_states(country = \"Brazil\",\n                 returnclass = \"sf\")\n\n\nlibrary(ggrepel)\nlibrary(scatterpie)\n\n#geom_scatterpie --&gt; Para fazer o grafico de pizza e legenda com as doenças ocorrentes. \n\n# geom_text_repel(data = mapa, aes(lon, lat, label = Local)) --&gt; Para colocar os nomes da cidade no mapa.\n\n\nlibrary(gsheet)\n\nmapa &lt;- gsheet2tbl(\"https://docs.google.com/spreadsheets/d/1pAIFKsdKxk_UQQXdYwIO-O5NOkYNhpclImJcLziYnk4/edit#gid=50258992\")\n\n\nlibrary(ggrepel)\nlibrary(scatterpie)\n\n\nggplot(BRA) +\n  geom_sf(fill = \"gray70\", alpha = 0.5, color = \"white\") +\n  coord_sf()+\n  geom_scatterpie(aes(x = lon, y = lat, r = 0.6), alpha = 0.8, color = NA, data = mapa,\n                  cols = c(\"DFC\",\n                           \"MA\",\n                           \"FER\",\n                           \"ANTR\",\n                           \"OIDIO\"))+\n  geom_text_repel(data = mapa, aes(lon, lat, label = Local),\n                   size = 2, nudge_x = 0.2, nudge_y = 0.27, color = \"gray30\", family = \"Arial\") +\n  ggthemes::scale_fill_calc()+\n  ggthemes::theme_map() +\n  labs(x = \"Longitude\", y = \"Latitude\", legend = \"\", fill = \"Doença\")+\n  theme(legend.position = \"bottom\", text = element_text(family = \"Arial\", size = 8))"
  },
  {
    "objectID": "about.html",
    "href": "about.html",
    "title": "About",
    "section": "",
    "text": "About this site\n\n1 + 1\n\n[1] 2"
  },
  {
    "objectID": "aula 2.html",
    "href": "aula 2.html",
    "title": "Download do R",
    "section": "",
    "text": "Download do R\nLink para instalação do R e R Studio\n\n\nInstalação de pacotes\nA instalação de pacotes é uma etapa crucial na realização de análise de dados, pode ser feita pelo CRAN ou GitHub e deve ser feita seguindo os passos a seguir:\n\nPacotes do CRAN que é o repositorio oficial do R.\n\nTools -&gt; Install Packages -&gt; \"digitar o nome do pacote\" -&gt; Install ou usando a função \"instal.packages(nome do pacote)\" no console\n\nPacotes do GitHub:\n\nUtiliza a função install_github()\nExemplo: remotes::install_github(\"emdelponte/r4pde\")\n\n\nCarregamento dos pacotes\nO carregamento dos pacotes pode ser feito diretamente através do console, digitando library e entre parenteses o nome do pacote. Obs: lembrar sempre de carregar um pacote antes de utilizar-lo.\nPara inserir um novo chunk (ctrl + alt + I).\n\n# Exemplo\n\nlibrary(tidyverse)\nlibrary(dplyr)"
  },
  {
    "objectID": "aula5.html",
    "href": "aula5.html",
    "title": "Pacotes",
    "section": "",
    "text": "Pacotes\n\nlibrary(gsheet)\nlibrary(tidyverse)\nlibrary(ggthemes)\nlibrary(dplyr)\nlibrary(patchwork)\n\n\n\nImporta o arquivo da planilha online\n\nnotas &lt;- gsheet2tbl(\"https://docs.google.com/spreadsheets/d/1bq2N19DcZdtax2fQW9OHSGMR0X2__Z9T/edit#gid=1092065531\")\n\n\n\nSeparação das notas da prova 1 e prova 2\n\nnotas1 &lt;- notas %&gt;% \n  select(prova, nota) %&gt;% \n  filter(prova == \"1\")\nnotas1\n\n# A tibble: 22 × 2\n   prova  nota\n   &lt;dbl&gt; &lt;dbl&gt;\n 1     1  71.4\n 2     1  92.9\n 3     1  85.7\n 4     1  42.9\n 5     1 100  \n 6     1  85.7\n 7     1 100  \n 8     1  57.1\n 9     1 100  \n10     1  71.4\n# ℹ 12 more rows\n\nnotas2 &lt;- notas %&gt;% \n  select(prova, nota) %&gt;% \n  filter(prova == \"2\")\nnotas2\n\n# A tibble: 22 × 2\n   prova  nota\n   &lt;dbl&gt; &lt;dbl&gt;\n 1     2  81.2\n 2     2  68.8\n 3     2  87.5\n 4     2  87.5\n 5     2  87.5\n 6     2 100  \n 7     2 100  \n 8     2 100  \n 9     2 100  \n10     2  43.8\n# ℹ 12 more rows\n\n\n\n\nCalculo das médias das provas 1 e 2\n\nmedia1 &lt;- mean(notas1$nota)\nmedia2 &lt;- mean(notas2$nota)\n\n\n\nGráfico de Histograma\nQuando comparamos as notas da prova 1 em relação prova 2, a maioria dos alunos obtiveram notas superiores a 90 na prova 1. Porém a média das duas provas, de maneira geral, foram iguais.\n\n#Gerei um gráfico das notas da prova 1\nplot1 &lt;- notas1 %&gt;% \n  ggplot(aes(x = nota)) +\n  geom_histogram(bins = 5, fill = \"darkmagenta\", color = \"black\") +\n  labs(y = \"Frequência\",\n       x = \"Nota\", title = \"Prova 1\") +\n  geom_vline(xintercept = media1 , color = \"black\", linetype = \"dashed\") +\n   annotate(geom = \"text\", \n            x= 66,\n            y = 7.5,\n            label = \"Média: 79.55\") + ylim(0,10) +\n  theme_few() \n\nplot1\n\n\n\n#Gerei um gráfico das notas da prova 2\nplot2 &lt;- notas2 %&gt;% \n    ggplot(aes(x = nota)) +\n  geom_histogram(bins = 5, fill = \"steelblue\", color = \"black\") +\n  labs(y = \"Frequência\",\n       x = \"Nota\", title = \"Prova 2\") +\n  geom_vline(xintercept = media1 , color = \"black\", linetype = \"dashed\") +\n   annotate(geom = \"text\", \n            x= 66.5,\n            y = 7.5,\n            label = \"Média: 79.26\") +  ylim(0,10) + \n  theme_few()\n\nplot2\n\n\n\n#Carreguei o pacote \"library(patchwork)\" e através do \"|\" coloquei os dois gráficos lado a lado.\n(plot1|plot2)\n\n\n\n\nObs: Para inserir a linha verical de interceptação da média:\ngeom_vline(xintercept = media1 , color = “black”, linetype = “dashed”) + annotate(geom = “text”, x= 75, y = 7.5, label = “Média”)\n\n\nGráfico de Barra de erro\nAtravés do gráfico de barra de erro foi possível observar que não houve diferença entre as médias das provas 1 e 2.\n\nnotas_resumo &lt;- notas %&gt;% \n  group_by(prova) %&gt;% \n  summarise(media = mean(nota), sd = sd(nota))\n\nnotas_resumo %&gt;% \n  ggplot(aes(x = as.factor(prova), y = media)) +\n  geom_point() +\n  geom_errorbar(aes(ymin = media - sd, ymax = media + sd), width = 0.1, color = \"darkmagenta\") +\n  theme_few() + ylim(0,100)+\n  labs( x = \"Provas\",\n        y = \"Nota\")\n\n\n\n\n\n\nGráfico Boxplot:\n\nnotas %&gt;% \n  ggplot(aes(x = as.factor(prova), \n             y = nota)) +\n  geom_errorbar(stat = \"boxplot\", width = 0.1, size = 1) + #o limite da barra de erros que segue o padrão do boxplot\n  geom_boxplot(width = 0.5, fill = \"#C2A5CF\") + #width- mexe na largura da caixa\n  geom_point(stat = \"summary\", fun = \"mean\", shape = 4, size = 2, color = \"red\") + #a média é representada por um \"X\", onde eu utlizei o resumo do meus dados, utilizando a função média. \n  labs (x = \"Prova\",\n        y = \"Notas\")+\n  geom_jitter(alpha = 0.6, height = 0, width = 0.25, color = \"black\", size = 1.5) + #alpha - transparencia dos meus pontos\n  theme_few() + ylim(0,100)"
  },
  {
    "objectID": "funcoes.html",
    "href": "funcoes.html",
    "title": "Exemplo com aplicação e visualização gráfica das funções e verbos do dplyr",
    "section": "",
    "text": "# &lt;- \n# =\n\na &lt;- 1\nb = 1\na\n\n[1] 1\n\n\n\n\n\nExemplos de vetores numéricos - Inteiro e decimal\n\n# Númerico inteiro\nserie1 &lt;- c(1:4)\n\n# Númerico decimal \nserie2 &lt;- c(1.5,2.5,3.5,4.5)\n\n# Caractere\nserie3 &lt;- c(\"um\", \"dois\", \"tres\", \"quatro\")\n\n# Booleano (verdadeiro ou falso)\nserie4 &lt;- c(TRUE, FALSE, FALSE, FALSE)\n\n#serie4: binario \n#Vetores independentes\n\n\n\n\n\na &lt;- \"Isabela - qualquer texto com mais de uma palavra\"\na &lt;- c(\"um\", \"dois\", \"tres\")"
  },
  {
    "objectID": "funcoes.html#operadores-básicos",
    "href": "funcoes.html#operadores-básicos",
    "title": "Exemplo com aplicação e visualização gráfica das funções e verbos do dplyr",
    "section": "",
    "text": "# &lt;- \n# =\n\na &lt;- 1\nb = 1\na\n\n[1] 1\n\n\n\n\n\nExemplos de vetores numéricos - Inteiro e decimal\n\n# Númerico inteiro\nserie1 &lt;- c(1:4)\n\n# Númerico decimal \nserie2 &lt;- c(1.5,2.5,3.5,4.5)\n\n# Caractere\nserie3 &lt;- c(\"um\", \"dois\", \"tres\", \"quatro\")\n\n# Booleano (verdadeiro ou falso)\nserie4 &lt;- c(TRUE, FALSE, FALSE, FALSE)\n\n#serie4: binario \n#Vetores independentes\n\n\n\n\n\na &lt;- \"Isabela - qualquer texto com mais de uma palavra\"\na &lt;- c(\"um\", \"dois\", \"tres\")"
  },
  {
    "objectID": "funcoes.html#criando-data-frame",
    "href": "funcoes.html#criando-data-frame",
    "title": "Exemplo com aplicação e visualização gráfica das funções e verbos do dplyr",
    "section": "Criando data frame",
    "text": "Criando data frame\nNesta etapa iremos criar um dataframe (base de dados) a partir de variaveis individuais que foram criadas previamente. A principal caracteristica de um data frame é possuir linha e colunas.\nCria uma tabela com variaveis (pode ser diferentes - numerica inteira, decimal, caractere.. ) de mesmo tamanho para visualizar meus dados.\nObs: cars- já é um data frame, que tem o “speed” e o “dist” como variavel. Se quiser criar um data frame a partir de outro data frame so precisa do sinal de atribuição (&lt;-)"
  },
  {
    "objectID": "funcoes.html#exporando-os-dados",
    "href": "funcoes.html#exporando-os-dados",
    "title": "Exemplo com aplicação e visualização gráfica das funções e verbos do dplyr",
    "section": "Exporando os dados:",
    "text": "Exporando os dados:\n\nImporta dados\n\nlibrary(tidyverse)\n\ncr &lt;- read_csv(\"https://raw.githubusercontent.com/emdelponte/paper-coffee-rust-Ethiopia/master/data/survey_clean.csv\")\n\n\n\nAprender a exportação:\nPacote que permite fazer essa exportação é writexl\n\nA partir do data frame vamos exportar para um formato .xlsx ou .csv\n\n\nlibrary(writexl)\n\nwrite_xlsx(cr, \"cr.xlsx\")\n\nwrite_csv(cr, \"cr.csv\")"
  },
  {
    "objectID": "funcoes.html#funções-de-manipulação-de-dados",
    "href": "funcoes.html#funções-de-manipulação-de-dados",
    "title": "Exemplo com aplicação e visualização gráfica das funções e verbos do dplyr",
    "section": "Funções de manipulação de dados:",
    "text": "Funções de manipulação de dados:\nIremos rever algumas funções ou verbos do pacote dplyr\n\nSelect()\n\nVariação de como selecionar as colunas utilizando os criterios.\n\n\n# Estou selecionando apenas algumas colunas, 1 a 10 e a coluna 13.\n\ncr %&gt;% \n  select(1:10, 13)\n\n# A tibble: 405 × 11\n    farm region zone       district      lon   lat altitude cultivar shade    \n   &lt;dbl&gt; &lt;chr&gt;  &lt;chr&gt;      &lt;chr&gt;       &lt;dbl&gt; &lt;dbl&gt;    &lt;dbl&gt; &lt;chr&gt;    &lt;chr&gt;    \n 1     1 SNNPR  Bench Maji Debub Bench  35.4  6.90     1100 Local    Sun      \n 2     2 SNNPR  Bench Maji Debub Bench  35.4  6.90     1342 Mixture  Mid shade\n 3     3 SNNPR  Bench Maji Debub Bench  35.4  6.90     1434 Mixture  Mid shade\n 4     4 SNNPR  Bench Maji Debub Bench  35.4  6.90     1100 Local    Sun      \n 5     5 SNNPR  Bench Maji Debub Bench  35.4  6.90     1400 Local    Sun      \n 6     6 SNNPR  Bench Maji Debub Bench  35.4  6.90     1342 Mixture  Mid shade\n 7     7 SNNPR  Bench Maji Debub Bench  35.4  6.90     1432 Mixture  Mid shade\n 8     8 SNNPR  Bench Maji Debub Bench  35.4  6.90     1100 Local    Sun      \n 9     9 SNNPR  Bench Maji Debub Bench  35.4  6.89     1400 Local    Sun      \n10    10 SNNPR  Bench Maji Debub Bench  35.4  6.88     1342 Mixture  Mid shade\n# ℹ 395 more rows\n# ℹ 2 more variables: cropping_system &lt;chr&gt;, sev2 &lt;dbl&gt;\n\n# Posso selecionar as coluna por nomes. \n\ncr %&gt;% \n  select(farm, region, inc, sev2)\n\n# A tibble: 405 × 4\n    farm region   inc  sev2\n   &lt;dbl&gt; &lt;chr&gt;  &lt;dbl&gt; &lt;dbl&gt;\n 1     1 SNNPR   86.7 55.6 \n 2     2 SNNPR   51.3 17.9 \n 3     3 SNNPR   43.2  8.25\n 4     4 SNNPR   76.7 46.1 \n 5     5 SNNPR   47.2 12.3 \n 6     6 SNNPR   51.3 19.9 \n 7     7 SNNPR   48.3 11.9 \n 8     8 SNNPR   86.7 55.6 \n 9     9 SNNPR   47.2 11.6 \n10    10 SNNPR   51.1 11.4 \n# ℹ 395 more rows\n\n# Selecionei todas as colunas, menos a \"sev2\".\n\ncr %&gt;% \n  select(-sev2)\n\n# A tibble: 405 × 12\n    farm region zone       district      lon   lat altitude cultivar shade    \n   &lt;dbl&gt; &lt;chr&gt;  &lt;chr&gt;      &lt;chr&gt;       &lt;dbl&gt; &lt;dbl&gt;    &lt;dbl&gt; &lt;chr&gt;    &lt;chr&gt;    \n 1     1 SNNPR  Bench Maji Debub Bench  35.4  6.90     1100 Local    Sun      \n 2     2 SNNPR  Bench Maji Debub Bench  35.4  6.90     1342 Mixture  Mid shade\n 3     3 SNNPR  Bench Maji Debub Bench  35.4  6.90     1434 Mixture  Mid shade\n 4     4 SNNPR  Bench Maji Debub Bench  35.4  6.90     1100 Local    Sun      \n 5     5 SNNPR  Bench Maji Debub Bench  35.4  6.90     1400 Local    Sun      \n 6     6 SNNPR  Bench Maji Debub Bench  35.4  6.90     1342 Mixture  Mid shade\n 7     7 SNNPR  Bench Maji Debub Bench  35.4  6.90     1432 Mixture  Mid shade\n 8     8 SNNPR  Bench Maji Debub Bench  35.4  6.90     1100 Local    Sun      \n 9     9 SNNPR  Bench Maji Debub Bench  35.4  6.89     1400 Local    Sun      \n10    10 SNNPR  Bench Maji Debub Bench  35.4  6.88     1342 Mixture  Mid shade\n# ℹ 395 more rows\n# ℹ 3 more variables: cropping_system &lt;chr&gt;, farm_management &lt;chr&gt;, inc &lt;dbl&gt;\n\n# Para quando tem muitas colunas que quero excluir.\n\ncr %&gt;% \n  select(- c(inc, sev2))\n\n# A tibble: 405 × 11\n    farm region zone       district      lon   lat altitude cultivar shade    \n   &lt;dbl&gt; &lt;chr&gt;  &lt;chr&gt;      &lt;chr&gt;       &lt;dbl&gt; &lt;dbl&gt;    &lt;dbl&gt; &lt;chr&gt;    &lt;chr&gt;    \n 1     1 SNNPR  Bench Maji Debub Bench  35.4  6.90     1100 Local    Sun      \n 2     2 SNNPR  Bench Maji Debub Bench  35.4  6.90     1342 Mixture  Mid shade\n 3     3 SNNPR  Bench Maji Debub Bench  35.4  6.90     1434 Mixture  Mid shade\n 4     4 SNNPR  Bench Maji Debub Bench  35.4  6.90     1100 Local    Sun      \n 5     5 SNNPR  Bench Maji Debub Bench  35.4  6.90     1400 Local    Sun      \n 6     6 SNNPR  Bench Maji Debub Bench  35.4  6.90     1342 Mixture  Mid shade\n 7     7 SNNPR  Bench Maji Debub Bench  35.4  6.90     1432 Mixture  Mid shade\n 8     8 SNNPR  Bench Maji Debub Bench  35.4  6.90     1100 Local    Sun      \n 9     9 SNNPR  Bench Maji Debub Bench  35.4  6.89     1400 Local    Sun      \n10    10 SNNPR  Bench Maji Debub Bench  35.4  6.88     1342 Mixture  Mid shade\n# ℹ 395 more rows\n# ℹ 2 more variables: cropping_system &lt;chr&gt;, farm_management &lt;chr&gt;\n\n\n\n\nFilter()\n\nFiltar apenas linhas especificas.\n\n\ncr %&gt;% \n  select(farm, region, inc) %&gt;% \n  filter(inc &gt; 50)\n\n# A tibble: 70 × 3\n    farm region   inc\n   &lt;dbl&gt; &lt;chr&gt;  &lt;dbl&gt;\n 1     1 SNNPR   86.7\n 2     2 SNNPR   51.3\n 3     4 SNNPR   76.7\n 4     6 SNNPR   51.3\n 5     8 SNNPR   86.7\n 6    10 SNNPR   51.1\n 7    12 SNNPR   76.0\n 8    14 SNNPR   51.3\n 9    16 SNNPR   53.2\n10    20 SNNPR   52.2\n# ℹ 60 more rows\n\ncr %&gt;% \n  select(farm, region, inc) %&gt;% \n  filter(region == \"SNNPR\")\n\n# A tibble: 240 × 3\n    farm region   inc\n   &lt;dbl&gt; &lt;chr&gt;  &lt;dbl&gt;\n 1     1 SNNPR   86.7\n 2     2 SNNPR   51.3\n 3     3 SNNPR   43.2\n 4     4 SNNPR   76.7\n 5     5 SNNPR   47.2\n 6     6 SNNPR   51.3\n 7     7 SNNPR   48.3\n 8     8 SNNPR   86.7\n 9     9 SNNPR   47.2\n10    10 SNNPR   51.1\n# ℹ 230 more rows\n\ncr %&gt;% \n  select(farm, region, zone, inc) %&gt;% \n  filter(zone == \"Bench Maji\")\n\n# A tibble: 45 × 4\n    farm region zone         inc\n   &lt;dbl&gt; &lt;chr&gt;  &lt;chr&gt;      &lt;dbl&gt;\n 1     1 SNNPR  Bench Maji  86.7\n 2     2 SNNPR  Bench Maji  51.3\n 3     3 SNNPR  Bench Maji  43.2\n 4     4 SNNPR  Bench Maji  76.7\n 5     5 SNNPR  Bench Maji  47.2\n 6     6 SNNPR  Bench Maji  51.3\n 7     7 SNNPR  Bench Maji  48.3\n 8     8 SNNPR  Bench Maji  86.7\n 9     9 SNNPR  Bench Maji  47.2\n10    10 SNNPR  Bench Maji  51.1\n# ℹ 35 more rows\n\n#Estou pegando todas as zonas menos a Bench MAji. **\"!=\"**\ncr %&gt;% \n  select(farm, region, zone, inc) %&gt;% \n  filter(zone != \"Bench Maji\")\n\n# A tibble: 360 × 4\n    farm region zone    inc\n   &lt;dbl&gt; &lt;chr&gt;  &lt;chr&gt; &lt;dbl&gt;\n 1    46 SNNPR  Sheka  81.8\n 2    47 SNNPR  Sheka  29.5\n 3    48 SNNPR  Sheka  31.5\n 4    49 SNNPR  Sheka  54.5\n 5    50 SNNPR  Sheka  74.5\n 6    51 SNNPR  Sheka  32.7\n 7    52 SNNPR  Sheka  42.4\n 8    53 SNNPR  Sheka  74.2\n 9    54 SNNPR  Sheka  76.9\n10    55 SNNPR  Sheka  33.2\n# ℹ 350 more rows\n\n# Criando outro data frame: Criando um subconjunto do \"cr\". \n\ncr2 &lt;- cr %&gt;% \n  select(farm, region, zone, inc) %&gt;% \n  filter(zone != \"Bench Maji\")\n\n\nOutro operador dentro do filtro que permite selecionar mais de uma condição dentro do nome zone. Estou selecionando duas zonas “Bench Maji”, “Keffa”.\n%in%\n\ncr2 &lt;- cr %&gt;% \n  select(farm, region, zone, inc) %&gt;% \n  filter(zone %in% c(\"Bench Maji\", \"Keffa\"))\n\n\n\n\ncr %&gt;% \n  select(farm, region, zone, inc) %&gt;% \n  filter(region == \"SNNPR\") %&gt;% \n  filter(zone != \"Sidama\")\n\n# A tibble: 180 × 4\n    farm region zone         inc\n   &lt;dbl&gt; &lt;chr&gt;  &lt;chr&gt;      &lt;dbl&gt;\n 1     1 SNNPR  Bench Maji  86.7\n 2     2 SNNPR  Bench Maji  51.3\n 3     3 SNNPR  Bench Maji  43.2\n 4     4 SNNPR  Bench Maji  76.7\n 5     5 SNNPR  Bench Maji  47.2\n 6     6 SNNPR  Bench Maji  51.3\n 7     7 SNNPR  Bench Maji  48.3\n 8     8 SNNPR  Bench Maji  86.7\n 9     9 SNNPR  Bench Maji  47.2\n10    10 SNNPR  Bench Maji  51.1\n# ℹ 170 more rows\n\n\n\n\n\nPara exportar esse data frame “cr2”\n\ncr2 &lt;- cr %&gt;% \n  select(farm, region, zone, inc) %&gt;% \n  filter(zone != \"Bench Maji\")\n\n\nwrite_xlsx(cr2, \"cr2.xlsx\")\n\n\n\nSumarização\nCount(): Vai contar alguma coisa, para não ter que ficar contando um por um na tabela.\n\ncr %&gt;%\n  count(zone)\n\n# A tibble: 9 × 2\n  zone             n\n  &lt;chr&gt;        &lt;int&gt;\n1 Bale            30\n2 Bench Maji      45\n3 Gedio           45\n4 Ilu AbaBora     45\n5 Jimma           45\n6 Keffa           45\n7 Sheka           45\n8 Sidama          60\n9 West Wellega    45\n\n# Contar quantas zonas tenho em cada distrito. Deixa meu arquivo em formato longo, onde repete os nome da zone. \n\ncr %&gt;%\n  count(zone, district)\n\n# A tibble: 27 × 3\n   zone        district         n\n   &lt;chr&gt;       &lt;chr&gt;        &lt;int&gt;\n 1 Bale        Delo Menna      15\n 2 Bale        Harena Buluk    15\n 3 Bench Maji  Debub Bench     15\n 4 Bench Maji  Guraferda       15\n 5 Bench Maji  Sheko           15\n 6 Gedio       Dila Zuria      15\n 7 Gedio       Wenago          15\n 8 Gedio       Yirgachefe      15\n 9 Ilu AbaBora Ale             15\n10 Ilu AbaBora Matu            15\n# ℹ 17 more rows\n\n\nOBS: Podemos fazer a mesma coisa do count(), utilizando o tally()\ngroup_by\n\ncr %&gt;%\n  group_by(zone, district) %&gt;% \n  tally()\n\n# A tibble: 27 × 3\n# Groups:   zone [9]\n   zone        district         n\n   &lt;chr&gt;       &lt;chr&gt;        &lt;int&gt;\n 1 Bale        Delo Menna      15\n 2 Bale        Harena Buluk    15\n 3 Bench Maji  Debub Bench     15\n 4 Bench Maji  Guraferda       15\n 5 Bench Maji  Sheko           15\n 6 Gedio       Dila Zuria      15\n 7 Gedio       Wenago          15\n 8 Gedio       Yirgachefe      15\n 9 Ilu AbaBora Ale             15\n10 Ilu AbaBora Matu            15\n# ℹ 17 more rows\n\n\n\n\nTabela de contigencia:\nPara saber quantas ocorrencias tem, fazendo o cruzamento de region e cultivar, como se fosse uma tabela.\nUtiliza o pacote janitor que tem a função tabyl\n\nA função tabyl é muito parecido com o count(), porém ele tras o nome das zonas, as contagem e o percentual. Isso quando selecionamos apenas uma coluna (zone).\n\n\nlibrary(janitor)\n\ncr %&gt;%\n  tabyl(zone)\n\n         zone  n    percent\n         Bale 30 0.07407407\n   Bench Maji 45 0.11111111\n        Gedio 45 0.11111111\n  Ilu AbaBora 45 0.11111111\n        Jimma 45 0.11111111\n        Keffa 45 0.11111111\n        Sheka 45 0.11111111\n       Sidama 60 0.14814815\n West Wellega 45 0.11111111\n\n# Tabela de contigencia: \n\ncr %&gt;%\n  tabyl(zone, cultivar)\n\n         zone Improved Local Mixture\n         Bale        0    14      16\n   Bench Maji        0    26      19\n        Gedio       15    13      17\n  Ilu AbaBora       14    11      20\n        Jimma        4     6      35\n        Keffa       11     0      34\n        Sheka        6    10      29\n       Sidama       28    17      15\n West Wellega        5    19      21\n\ncr %&gt;%\n  tabyl(cultivar, shade)\n\n cultivar Full shade Mid shade Sun\n Improved         83         0   0\n    Local          0         0 116\n  Mixture        127        79   0\n\n# Separa em duas tabela por região, quando utilizamos 3 variaveis (cultivar, shade, region). \n\ncr %&gt;%\n  tabyl(cultivar, shade, region)\n\n$Oromia\n cultivar Full shade Mid shade Sun\n Improved         23         0   0\n    Local          0         0  50\n  Mixture         58        34   0\n\n$SNNPR\n cultivar Full shade Mid shade Sun\n Improved         60         0   0\n    Local          0         0  66\n  Mixture         69        45   0\n\n\nOBS: - Para fazer um gráfico com a tabela de contigencia, é melhor usar o count() do que o tabyl(), porque ela precisa estar em formato longo. - O tabyl é mais interessante para olhar os valores e não para fazer gráfico.\n\ncr %&gt;%\n  count(cultivar, shade)\n\n# A tibble: 4 × 3\n  cultivar shade          n\n  &lt;chr&gt;    &lt;chr&gt;      &lt;int&gt;\n1 Improved Full shade    83\n2 Local    Sun          116\n3 Mixture  Full shade   127\n4 Mixture  Mid shade     79\n\n\n\n\nArrange()\n\nFaz uma reordenação para fins de visualização\n\n\n# Ordena do menor para o maior:\ncr %&gt;%\n  count(zone, shade) %&gt;% \n  arrange(n)\n\n# A tibble: 25 × 3\n   zone         shade          n\n   &lt;chr&gt;        &lt;chr&gt;      &lt;int&gt;\n 1 Keffa        Mid shade      4\n 2 Sidama       Mid shade      4\n 3 Bale         Mid shade      6\n 4 Jimma        Sun            6\n 5 Gedio        Mid shade      8\n 6 Jimma        Mid shade      8\n 7 West Wellega Mid shade      8\n 8 Bale         Full shade    10\n 9 Sheka        Mid shade     10\n10 Sheka        Sun           10\n# ℹ 15 more rows\n\n# Ordena por ordem alfabetica: \ncr %&gt;%\n  count(zone, shade) %&gt;% \n  arrange(shade)\n\n# A tibble: 25 × 3\n   zone         shade          n\n   &lt;chr&gt;        &lt;chr&gt;      &lt;int&gt;\n 1 Bale         Full shade    10\n 2 Gedio        Full shade    24\n 3 Ilu AbaBora  Full shade    22\n 4 Jimma        Full shade    31\n 5 Keffa        Full shade    41\n 6 Sheka        Full shade    25\n 7 Sidama       Full shade    39\n 8 West Wellega Full shade    18\n 9 Bale         Mid shade      6\n10 Bench Maji   Mid shade     19\n# ℹ 15 more rows"
  },
  {
    "objectID": "importacao.html",
    "href": "importacao.html",
    "title": "Importação e dados do próprio R:",
    "section": "",
    "text": "Importação e dados do próprio R:\n\nlibrary(agridat)\ncars\n\n   speed dist\n1      4    2\n2      4   10\n3      7    4\n4      7   22\n5      8   16\n6      9   10\n7     10   18\n8     10   26\n9     10   34\n10    11   17\n11    11   28\n12    12   14\n13    12   20\n14    12   24\n15    12   28\n16    13   26\n17    13   34\n18    13   34\n19    13   46\n20    14   26\n21    14   36\n22    14   60\n23    14   80\n24    15   20\n25    15   26\n26    15   54\n27    16   32\n28    16   40\n29    17   32\n30    17   40\n31    17   50\n32    18   42\n33    18   56\n34    18   76\n35    18   84\n36    19   36\n37    19   46\n38    19   68\n39    20   32\n40    20   48\n41    20   52\n42    20   56\n43    20   64\n44    22   66\n45    23   54\n46    24   70\n47    24   92\n48    24   93\n49    24  120\n50    25   85\n\n\n\nlibrary(ec50estimator)\ndf1 &lt;- multi_isolate\n\n\n\nPlanilhas do excel:\n\nlibrary(readxl)\n# Utilizando a primeira aba da planilha \"magnesio\"\ndf2 &lt;- read_excel (\"dados-diversos.xlsx\")\n\n# Utilizando a segunda aba da planilha \"mortalidade\"\ndf3 &lt;- read_excel(\"dados-diversos.xlsx\", 4)\n\n# Utilizando a terceira aba da planilha \"micelial\"\ndf4 &lt;- read_excel(\"dados-diversos.xlsx\", \"micelial\")\n\n\n\nArquivo .csv:\n\nlibrary(tidyverse)\ndf5 &lt;- read_csv(\"dados-diversos.csv\", \"milho\")\n\n\n\nDados em planilha online:\n\nlibrary(gsheet)\ndf6 &lt;- gsheet2tbl(\"https://docs.google.com/spreadsheets/d/1bq2N19DcZdtax2fQW9OHSGMR0X2__Z9T/edit#gid=983033137\")\n\n\n\nVisualização dos dados\n\nlibrary(ggthemes)\nlibrary(ggplot2)\n\ng1 &lt;- df6 %&gt;% \n  ggplot(aes(trat, comp))+\n  geom_boxplot(outlier.colour = NA,\n               fill = \"darkmagenta\") + \n  geom_jitter(width = 0.05, color = \"black\", shape = 2, size = 3)+\n  theme_clean()+\n  labs(x = \"Tratamento\",\n       y = \"Comprimento (mm)\", \n       title = \"Meu primeiro ggplot\", \n       caption = \"fonte: Dados diversos\") +\n  scale_y_continuous(limits = c(0,20), n.breaks = 10)\n\ng1\n\n\n\n# Para salvar o ggplot na pasta em PNG, PDF, JPEG e outros.\nggsave(\"plot1.png\", bg= \"white\")"
  },
  {
    "objectID": "regressao.html",
    "href": "regressao.html",
    "title": "FIP606",
    "section": "",
    "text": "library(gsheet)\nlibrary(tidyverse)\nmilho &lt;- gsheet2tbl(\"https://docs.google.com/spreadsheets/d/1bq2N19DcZdtax2fQW9OHSGMR0X2__Z9T/edit#gid=1345524759\")\nmilho &lt;- milho |&gt; \n  mutate(TRAT = as.factor(hybrid),\n         BLOCO = as.factor(block))"
  },
  {
    "objectID": "regressao.html#index",
    "href": "regressao.html#index",
    "title": "FIP606",
    "section": "Index",
    "text": "Index\n\nmilho %&gt;% \nggplot(aes(method, index))+\n  geom_jitter(width = 0.1, alpha= 0.2) +\n  facet_wrap(~hybrid) +\n  stat_summary(fun.data = \"mean_cl_boot\", size= 0.5, color = \"blue\")\n\n\n\n\n\nModelo para subdivida\n\nlibrary(lme4)\nlibrary(car)\n\n\nmilho&lt;- milho %&gt;% \n  mutate(block = as.factor(block))\n\nmix2 &lt;- lmer(index ~ hybrid*method + block +       #fator fixo \n               (1|block/hybrid), data = milho)\n\nAnova(mix2)\n\nAnalysis of Deviance Table (Type II Wald chisquare tests)\n\nResponse: index\n                Chisq Df Pr(&gt;Chisq)   \nhybrid        15.5971  5   0.008094 **\nmethod         4.6963  1   0.030228 * \nblock          0.2157  3   0.975023   \nhybrid:method 15.8060  5   0.007420 **\n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\n#para saber se esse modelo está correto temo que testar as premissas\n\n\n\nTestar as premissas\n\nlibrary(performance)\n\ncheck_normality(mix2)\n\nOK: residuals appear as normally distributed (p = 0.635).\n\ncheck_heteroscedasticity(mix2)\n\nWarning: Heteroscedasticity (non-constant error variance) detected (p = 0.009).\n\nmix2 &lt;- lmer(sqrt(index) ~ hybrid*method + block +        \n               (1|block/hybrid), data = milho)\n\nlibrary(DHARMa)\nplot(simulateResiduals(mix2))\n\n\n\nqqnorm(residuals(mix2))\nqqline(residuals(mix2))\n\n\n\nhist(residuals(mix2))\n\n\n\nlibrary(emmeans)\n\nmedias_milho &lt;- emmeans(mix2,\n                        ~ hybrid | method,\n                        type = \"response\")\n\nmedias_milho2 &lt;- emmeans(mix2,\n                        ~ method | hybrid,\n                        type = \"response\")\n\nlibrary(multcomp)\ncld(medias_milho, Letters = LETTERS)\n\nmethod = pin:\n hybrid   response   SE   df lower.CL upper.CL .group\n BG7049H      19.4 10.7 6084     4.10     46.0  A    \n 30K64        20.3 10.9 6084     4.51     47.4  A    \n 30F53 YH     24.5 12.0 6084     6.61     53.7  AB   \n 30F53 HX     25.0 12.1 6084     6.84     54.4  AB   \n 30S31YH      31.7 13.7 6084    10.57     64.2  AB   \n 30S31H       37.1 14.8 6084    13.79     71.8   B   \n\nmethod = silk:\n hybrid   response   SE   df lower.CL upper.CL .group\n BG7049H      19.1 10.6 6084     3.96     45.6  A    \n 30K64        21.3 11.2 6084     5.00     48.9  A    \n 30F53 HX     24.4 12.0 6084     6.56     53.6  A    \n 30F53 YH     26.0 12.4 6084     7.42     56.0  A    \n 30S31H       26.3 12.5 6084     7.57     56.4  A    \n 30S31YH      26.4 12.5 6084     7.62     56.5  A    \n\nResults are averaged over the levels of: block \nDegrees-of-freedom method: kenward-roger \nConfidence level used: 0.95 \nIntervals are back-transformed from the sqrt scale \nNote: contrasts are still on the sqrt scale \nP value adjustment: tukey method for comparing a family of 6 estimates \nsignificance level used: alpha = 0.05 \nNOTE: If two or more means share the same grouping symbol,\n      then we cannot show them to be different.\n      But we also did not show them to be the same. \n\ncld(medias_milho2)\n\nhybrid = 30F53 HX:\n method response   SE   df lower.CL upper.CL .group\n silk       24.4 12.0 6084     6.56     53.6  1    \n pin        25.0 12.1 6084     6.84     54.4  1    \n\nhybrid = 30F53 YH:\n method response   SE   df lower.CL upper.CL .group\n pin        24.5 12.0 6084     6.61     53.7  1    \n silk       26.0 12.4 6084     7.42     56.0  1    \n\nhybrid = 30K64:\n method response   SE   df lower.CL upper.CL .group\n pin        20.3 10.9 6084     4.51     47.4  1    \n silk       21.3 11.2 6084     5.00     48.9  1    \n\nhybrid = 30S31H:\n method response   SE   df lower.CL upper.CL .group\n silk       26.3 12.5 6084     7.57     56.4  1    \n pin        37.1 14.8 6084    13.79     71.8   2   \n\nhybrid = 30S31YH:\n method response   SE   df lower.CL upper.CL .group\n silk       26.4 12.5 6084     7.62     56.5  1    \n pin        31.7 13.7 6084    10.57     64.2  1    \n\nhybrid = BG7049H:\n method response   SE   df lower.CL upper.CL .group\n silk       19.1 10.6 6084     3.96     45.6  1    \n pin        19.4 10.7 6084     4.10     46.0  1    \n\nResults are averaged over the levels of: block \nDegrees-of-freedom method: kenward-roger \nConfidence level used: 0.95 \nIntervals are back-transformed from the sqrt scale \nNote: contrasts are still on the sqrt scale \nsignificance level used: alpha = 0.05 \nNOTE: If two or more means share the same grouping symbol,\n      then we cannot show them to be different.\n      But we also did not show them to be the same. \n\n\n\nmix3 &lt;- lmer(sqrt(yield) ~ hybrid*method + block +        \n               (1|block/hybrid), data = milho)\n\nAnova(mix3)\n\nAnalysis of Deviance Table (Type II Wald chisquare tests)\n\nResponse: sqrt(yield)\n                Chisq Df Pr(&gt;Chisq)    \nhybrid        25.5591  5  0.0001086 ***\nmethod         0.0520  1  0.8196750    \nblock          2.3606  3  0.5010021    \nhybrid:method 24.4985  5  0.0001741 ***\n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\ncheck_heteroscedasticity(mix3)\n\nOK: Error variance appears to be homoscedastic (p = 0.686).\n\ncheck_normality(mix3)\n\nOK: residuals appear as normally distributed (p = 0.214)."
  },
  {
    "objectID": "regressao.html#regressão-linear",
    "href": "regressao.html#regressão-linear",
    "title": "FIP606",
    "section": "Regressão linear",
    "text": "Regressão linear\n\nestande &lt;- gsheet2tbl(\"https://docs.google.com/spreadsheets/d/1bq2N19DcZdtax2fQW9OHSGMR0X2__Z9T/edit#gid=401662555\")\n\nestande\n\n# A tibble: 72 × 4\n     exp  trat bloco nplants\n   &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;   &lt;dbl&gt;\n 1     1     0     1      66\n 2     1     0     2      72\n 3     1     0     3      50\n 4     1     0     4      27\n 5     1     3     1      68\n 6     1     3     2      79\n 7     1     3     3      31\n 8     1     3     4      32\n 9     1     6     1      58\n10     1     6     2      56\n# ℹ 62 more rows\n\n\n\nestande |&gt;\n  ggplot(aes(trat, nplants))+\n  geom_jitter(wdth = 0.1, alpha = 0.2) +\n  facet_wrap(~ exp) +\n   stat_summary(fun.data = \"mean_cl_boot\", size= 0.5, color = \"blue\") +\n  geom_smooth(method = \"lm\", se = F)    #regresão linear\n\n\n\n  exp1 &lt;- estande %&gt;% \n    filter(exp == 1)\n  \n  exp1 %&gt;% \n    ggplot(aes(trat, nplants))+\n    geom_point()+\n    ylim(0,100) +\n    geom_smooth(se = F, method = lm)\n\n\n\n  #modelo linear\n  \n  lm1 &lt;- lm(nplants~ trat,\n            data = exp1)\nsummary(lm1)\n\n\nCall:\nlm(formula = nplants ~ trat, data = exp1)\n\nResiduals:\n    Min      1Q  Median      3Q     Max \n-25.500  -6.532   1.758   8.573  27.226 \n\nCoefficients:\n            Estimate Std. Error t value Pr(&gt;|t|)    \n(Intercept)  52.5000     4.2044  12.487 1.84e-11 ***\ntrat         -0.2419     0.1859  -1.301    0.207    \n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\nResidual standard error: 15 on 22 degrees of freedom\nMultiple R-squared:  0.07148,   Adjusted R-squared:  0.02928 \nF-statistic: 1.694 on 1 and 22 DF,  p-value: 0.2066\n\n exp2 &lt;- estande %&gt;% \n    filter(exp == 2)\n  \n  exp2 %&gt;% \n    ggplot(aes(trat, nplants))+\n    geom_point()+\n    ylim(0,100) +\n    geom_smooth(se = F, method = lm)\n\n\n\n lm2 &lt;- lm(nplants~ trat,\n            data = exp2)\nsummary(lm2)\n\n\nCall:\nlm(formula = nplants ~ trat, data = exp2)\n\nResiduals:\n     Min       1Q   Median       3Q      Max \n-25.7816  -7.7150   0.5653   8.1929  19.2184 \n\nCoefficients:\n            Estimate Std. Error t value Pr(&gt;|t|)    \n(Intercept)  60.9857     3.6304  16.798 4.93e-14 ***\ntrat         -0.7007     0.1605  -4.365 0.000247 ***\n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\nResidual standard error: 12.95 on 22 degrees of freedom\nMultiple R-squared:  0.4641,    Adjusted R-squared:  0.4398 \nF-statistic: 19.05 on 1 and 22 DF,  p-value: 0.0002473\n\n exp2 %&gt;% \n    ggplot(aes(trat, nplants))+\n    geom_point()+\n    ylim(0,100) +\n    geom_smooth(se = F, method = lm)\n\n\n\n lm2 &lt;- lm(nplants~ trat,\n            data = exp2)\nsummary(lm2)\n\n\nCall:\nlm(formula = nplants ~ trat, data = exp2)\n\nResiduals:\n     Min       1Q   Median       3Q      Max \n-25.7816  -7.7150   0.5653   8.1929  19.2184 \n\nCoefficients:\n            Estimate Std. Error t value Pr(&gt;|t|)    \n(Intercept)  60.9857     3.6304  16.798 4.93e-14 ***\ntrat         -0.7007     0.1605  -4.365 0.000247 ***\n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\nResidual standard error: 12.95 on 22 degrees of freedom\nMultiple R-squared:  0.4641,    Adjusted R-squared:  0.4398 \nF-statistic: 19.05 on 1 and 22 DF,  p-value: 0.0002473\n\n exp3 &lt;- estande %&gt;% \n    filter(exp == 3)\n  \n  exp3 %&gt;% \n    ggplot(aes(trat, nplants))+\n    geom_point()+\n    ylim(0,100) +\n    geom_smooth(se = F, method = lm)\n\n\n\n lm3 &lt;- lm(nplants~ trat,\n            data = exp3)\nsummary(lm3)\n\n\nCall:\nlm(formula = nplants ~ trat, data = exp3)\n\nResiduals:\n     Min       1Q   Median       3Q      Max \n-26.5887  -3.9597   0.7177   5.5806  19.8952 \n\nCoefficients:\n            Estimate Std. Error t value Pr(&gt;|t|)    \n(Intercept)  95.7500     2.9529  32.425  &lt; 2e-16 ***\ntrat         -0.7634     0.1306  -5.847 6.97e-06 ***\n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\nResidual standard error: 10.53 on 22 degrees of freedom\nMultiple R-squared:  0.6085,    Adjusted R-squared:  0.5907 \nF-statistic: 34.19 on 1 and 22 DF,  p-value: 6.968e-06\n\n\n\nModelo quadratico\n\nexp2 %&gt;% \n    ggplot(aes(trat, nplants))+\n    geom_point()+\n    ylim(0,100) +\n    geom_smooth(method = \"lm\",\n                se = FALSE,\n                formula = y ~poly(x,2),\n                color = \"black\")\n\n\n\n# Comparando o modelo linear com o quadradatico: \n\nexp2 %&gt;% \n    ggplot(aes(trat, nplants))+\n    geom_point()+\n    ylim(0,100) +\n    geom_smooth(method = lm,\n                se = FALSE,\n                formula = y ~poly(x,2),\n                color = \"black\") +\n  geom_smooth(method = \"lm\", se = FALSE)\n\n\n\n lm2 &lt;- lm(nplants~ trat,\n            data = exp2)\n \nsummary(lm2)\n\n\nCall:\nlm(formula = nplants ~ trat, data = exp2)\n\nResiduals:\n     Min       1Q   Median       3Q      Max \n-25.7816  -7.7150   0.5653   8.1929  19.2184 \n\nCoefficients:\n            Estimate Std. Error t value Pr(&gt;|t|)    \n(Intercept)  60.9857     3.6304  16.798 4.93e-14 ***\ntrat         -0.7007     0.1605  -4.365 0.000247 ***\n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\nResidual standard error: 12.95 on 22 degrees of freedom\nMultiple R-squared:  0.4641,    Adjusted R-squared:  0.4398 \nF-statistic: 19.05 on 1 and 22 DF,  p-value: 0.0002473\n\nhist(residuals(lm2))\n\n\n\n# Ajustar o modelo quadratico: para ter mais um coeficiente neste modelo (^2)\n\n# Primeira ordem\n\nexp2$trat2 &lt;- exp2$trat^2\n\n# Segunda ordem\n\nlm3&lt;- lm(nplants ~trat + trat2,\n         data = exp2)\nsummary(lm3)\n\n\nCall:\nlm(formula = nplants ~ trat + trat2, data = exp2)\n\nResiduals:\n    Min      1Q  Median      3Q     Max \n-25.439  -6.019   1.789   8.016  19.561 \n\nCoefficients:\n            Estimate Std. Error t value Pr(&gt;|t|)    \n(Intercept) 66.30156    4.42097  14.997 1.08e-12 ***\ntrat        -1.77720    0.58467  -3.040  0.00623 ** \ntrat2        0.02223    0.01166   1.906  0.07036 .  \n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\nResidual standard error: 12.24 on 21 degrees of freedom\nMultiple R-squared:  0.5432,    Adjusted R-squared:  0.4997 \nF-statistic: 12.49 on 2 and 21 DF,  p-value: 0.0002675\n\n#o r2 aumentou, explicando MELHOR. 50% DA VARIAÇÃO\n\nAIC(lm2)\n\n[1] 194.9597\n\nAIC(lm3)\n\n[1] 193.1284\n\nexp2$trat2 &lt;- exp2$trat^2\n\n#primeira ordem\nexp2$trat2 &lt;- exp2$trat^2\n\n# segunda ordem ou quadratico\nlm3&lt;- lm(nplants ~trat + trat2,\n         data = exp2)\nsummary(lm3)\n\n\nCall:\nlm(formula = nplants ~ trat + trat2, data = exp2)\n\nResiduals:\n    Min      1Q  Median      3Q     Max \n-25.439  -6.019   1.789   8.016  19.561 \n\nCoefficients:\n            Estimate Std. Error t value Pr(&gt;|t|)    \n(Intercept) 66.30156    4.42097  14.997 1.08e-12 ***\ntrat        -1.77720    0.58467  -3.040  0.00623 ** \ntrat2        0.02223    0.01166   1.906  0.07036 .  \n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\nResidual standard error: 12.24 on 21 degrees of freedom\nMultiple R-squared:  0.5432,    Adjusted R-squared:  0.4997 \nF-statistic: 12.49 on 2 and 21 DF,  p-value: 0.0002675\n\n#o r2 aumentou, explicando MELHOR. 50% DA VARIAÇÃO\nAIC(lm2)\n\n[1] 194.9597\n\nAIC(lm3)\n\n[1] 193.1284\n\n\n\n\nFazendo a mesmo coisa pelo agroR\n\nlibrary(AgroR)\n\nwith(exp2, polynomial(trat, nplants, grau = 1))\n\n\n----------------------------------------------------\nRegression Models\n----------------------------------------------------\n              Estimate Std. Error   t value     Pr(&gt;|t|)\n(Intercept) 60.9857143  3.6304377 16.798447 4.929311e-14\ntrat        -0.7006912  0.1605226 -4.365063 2.473272e-04\n\n----------------------------------------------------\nDeviations from regression\n----------------------------------------------------\n          Df      SSq       MSQ        F      p-value\nLinear     1 3196.203 3196.2031 21.82329 0.0001899378\nDeviation  4 1054.172  263.5430  1.79944 0.1729687460\nResidual  18 2636.250  146.4583                      \n\n\n[[1]]\n\n\n\n\n#polynomial(trat, nplants, grau = 1, data = exp2)\n\nwith(exp2, polynomial(trat, nplants, grau = 2))\n\n\n----------------------------------------------------\nRegression Models\n----------------------------------------------------\n               Estimate Std. Error   t value     Pr(&gt;|t|)\n(Intercept) 66.30156250 4.42096799 14.997069 1.079972e-12\ntrat        -1.77719814 0.58467380 -3.039640 6.230050e-03\nI(trat^2)    0.02222876 0.01165948  1.906496 7.036247e-02\n\n----------------------------------------------------\nDeviations from regression\n----------------------------------------------------\n          Df       SSq       MSQ         F      p-value\nLinear     1 3196.2031 3196.2031 21.823293 0.0001899378\nQuadratic  1  544.5029  544.5029  3.717801 0.0697619482\nDeviation  3  509.6690  169.8897  1.159986 0.3523240106\nResidual  18 2636.2500  146.4583                       \n\n\n[[1]]\n\n\n\n\n# Grau 3 não utilizamos porque não tem explicação biologica.\n\nwith(exp2, polynomial(trat, nplants, grau = 3))\n\n\n----------------------------------------------------\nRegression Models\n----------------------------------------------------\n                Estimate  Std. Error   t value     Pr(&gt;|t|)\n(Intercept) 70.265143802 5.300440019 13.256474 2.295186e-11\ntrat        -3.609380523 1.514625525 -2.383018 2.720299e-02\nI(trat^2)    0.140522077 0.091192577  1.540938 1.390058e-01\nI(trat^3)   -0.001712445 0.001309648 -1.307561 2.058546e-01\n\n----------------------------------------------------\nDeviations from regression\n----------------------------------------------------\n          Df       SSq       MSQ          F      p-value\nLinear     1 3196.2031 3196.2031 21.8232929 0.0001899378\nQuadratic  1  544.5029  544.5029  3.7178008 0.0697619482\nCubic      1  247.7520  247.7520  1.6916208 0.2097934169\nDeviation  2  261.9170  130.9585  0.8941691 0.4263523326\nResidual  18 2636.2500  146.4583                        \n\n\n[[1]]\n\n\n\n\n#library(agro3)\n#with(exp2, polynomial(trat, nplants, grau = 2))\n#data(\"phao\")\n#with(phao, polynomial(dose, comp, grau = 2))\n\n\nglm2 &lt;- glm(nplants ~ trat, family = \"gaussian\", \n            data = exp2)\nglm2\n\n\nCall:  glm(formula = nplants ~ trat, family = \"gaussian\", data = exp2)\n\nCoefficients:\n(Intercept)         trat  \n    60.9857      -0.7007  \n\nDegrees of Freedom: 23 Total (i.e. Null);  22 Residual\nNull Deviance:      6887 \nResidual Deviance: 3690     AIC: 195\n\nsummary(glm2)\n\n\nCall:\nglm(formula = nplants ~ trat, family = \"gaussian\", data = exp2)\n\nCoefficients:\n            Estimate Std. Error t value Pr(&gt;|t|)    \n(Intercept)  60.9857     3.6304  16.798 4.93e-14 ***\ntrat         -0.7007     0.1605  -4.365 0.000247 ***\n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\n(Dispersion parameter for gaussian family taken to be 167.7464)\n\n    Null deviance: 6886.6  on 23  degrees of freedom\nResidual deviance: 3690.4  on 22  degrees of freedom\nAIC: 194.96\n\nNumber of Fisher Scoring iterations: 2\n\nAIC(glm2)\n\n[1] 194.9597\n\nglm2b &lt;- glm(nplants ~ trat, family = \"poisson\" (link = log),\n             data = exp2)\n\nsummary(glm2b)\n\n\nCall:\nglm(formula = nplants ~ trat, family = poisson(link = log), data = exp2)\n\nCoefficients:\n             Estimate Std. Error z value Pr(&gt;|z|)    \n(Intercept)  4.134189   0.037583 110.003  &lt; 2e-16 ***\ntrat        -0.016270   0.002059  -7.901 2.76e-15 ***\n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\n(Dispersion parameter for poisson family taken to be 1)\n\n    Null deviance: 139.783  on 23  degrees of freedom\nResidual deviance:  69.578  on 22  degrees of freedom\nAIC: 210.24\n\nNumber of Fisher Scoring iterations: 4\n\nAIC(glm2b)\n\n[1] 210.2353\n\nglm3 &lt;- glm(nplants ~ trat, family = \"gaussian\", \n            data = exp3)\nglm3\n\n\nCall:  glm(formula = nplants ~ trat, family = \"gaussian\", data = exp3)\n\nCoefficients:\n(Intercept)         trat  \n    95.7500      -0.7634  \n\nDegrees of Freedom: 23 Total (i.e. Null);  22 Residual\nNull Deviance:      6236 \nResidual Deviance: 2442     AIC: 185\n\nsummary(glm3)\n\n\nCall:\nglm(formula = nplants ~ trat, family = \"gaussian\", data = exp3)\n\nCoefficients:\n            Estimate Std. Error t value Pr(&gt;|t|)    \n(Intercept)  95.7500     2.9529  32.425  &lt; 2e-16 ***\ntrat         -0.7634     0.1306  -5.847 6.97e-06 ***\n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\n(Dispersion parameter for gaussian family taken to be 110.9787)\n\n    Null deviance: 6235.8  on 23  degrees of freedom\nResidual deviance: 2441.5  on 22  degrees of freedom\nAIC: 185.04\n\nNumber of Fisher Scoring iterations: 2\n\nAIC(glm3)\n\n[1] 185.0449\n\nglm3b &lt;- glm(nplants ~ trat, family = \"poisson\" (link = log),\n             data = exp3)\n\nsummary(glm3b)\n\n\nCall:\nglm(formula = nplants ~ trat, family = poisson(link = log), data = exp3)\n\nCoefficients:\n             Estimate Std. Error z value Pr(&gt;|z|)    \n(Intercept)  4.571590   0.029539 154.762  &lt; 2e-16 ***\ntrat        -0.009965   0.001488  -6.697 2.13e-11 ***\n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\n(Dispersion parameter for poisson family taken to be 1)\n\n    Null deviance: 77.906  on 23  degrees of freedom\nResidual deviance: 29.952  on 22  degrees of freedom\nAIC: 183.93\n\nNumber of Fisher Scoring iterations: 4\n\nAIC(glm3b)\n\n[1] 183.9324\n\nlibrary(lme4)\n\nglm3 &lt;- glmer(nplants ~ trat + (trat | exp), family = \"gaussian\", \n            data = estande)\nglm3\n\nLinear mixed model fit by REML ['lmerMod']\nFormula: nplants ~ trat + (trat | exp)\n   Data: estande\nREML criterion at convergence: 580.8402\nRandom effects:\n Groups   Name        Std.Dev. Corr \n exp      (Intercept) 22.5983       \n          trat         0.2349  -0.82\n Residual             12.9581       \nNumber of obs: 72, groups:  exp, 3\nFixed Effects:\n(Intercept)         trat  \n    69.7452      -0.5687  \noptimizer (nloptwrap) convergence code: 0 (OK) ; 0 optimizer warnings; 1 lme4 warnings \n\nsummary(glm3)\n\nLinear mixed model fit by REML ['lmerMod']\nFormula: nplants ~ trat + (trat | exp)\n   Data: estande\n\nREML criterion at convergence: 580.8\n\nScaled residuals: \n    Min      1Q  Median      3Q     Max \n-2.0988 -0.6091  0.1722  0.6360  1.9963 \n\nRandom effects:\n Groups   Name        Variance  Std.Dev. Corr \n exp      (Intercept) 510.68405 22.5983       \n          trat          0.05516  0.2349  -0.82\n Residual             167.91303 12.9581       \nNumber of obs: 72, groups:  exp, 3\n\nFixed effects:\n            Estimate Std. Error t value\n(Intercept)  69.7452    13.2146   5.278\ntrat         -0.5687     0.1643  -3.462\n\nCorrelation of Fixed Effects:\n     (Intr)\ntrat -0.731\noptimizer (nloptwrap) convergence code: 0 (OK)\nModel failed to converge with max|grad| = 0.00274249 (tol = 0.002, component 1)\n\nAIC(glm3)\n\n[1] 592.8402\n\nglm3b &lt;- glmer(nplants ~ trat + ( trat | exp), family = \"poisson\" (link = \"log\"),\n             data = estande)\n\nsummary(glm3b)\n\nGeneralized linear mixed model fit by maximum likelihood (Laplace\n  Approximation) [glmerMod]\n Family: poisson  ( log )\nFormula: nplants ~ trat + (trat | exp)\n   Data: estande\n\n     AIC      BIC   logLik deviance df.resid \n   660.7    672.1   -325.4    650.7       67 \n\nScaled residuals: \n    Min      1Q  Median      3Q     Max \n-3.6247 -0.8083  0.1042  0.9601  3.6511 \n\nRandom effects:\n Groups Name        Variance  Std.Dev. Corr \n exp    (Intercept) 6.425e-02 0.253478      \n        trat        1.602e-05 0.004003 -0.17\nNumber of obs: 72, groups:  exp, 3\n\nFixed effects:\n             Estimate Std. Error z value Pr(&gt;|z|)    \n(Intercept)  4.223397   0.147793  28.577  &lt; 2e-16 ***\ntrat        -0.010434   0.002538  -4.111 3.93e-05 ***\n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\nCorrelation of Fixed Effects:\n     (Intr)\ntrat -0.192\n\nAIC(glm3b)\n\n[1] 660.7282\n\n#remotes::install_github(\"emdelponte/r4pe\")\n\nlibrary(r4pde)\nwm &lt;- WhiteMoldSoybean\n\nwm %&gt;% \n  ggplot(aes(inc, yld)) +\n  geom_point() +\n  facet_wrap(~study) +\n  theme_minimal()\n\n\n\nmofo1 &lt;- lm(yld ~ inc,\n            data = wm)\nsummary(mofo1)\n\n\nCall:\nlm(formula = yld ~ inc, data = wm)\n\nResiduals:\n     Min       1Q   Median       3Q      Max \n-1657.85  -594.50   -91.32   531.76  1693.15 \n\nCoefficients:\n            Estimate Std. Error t value Pr(&gt;|t|)    \n(Intercept) 3299.619     56.451  58.451  &lt; 2e-16 ***\ninc           -9.261      2.108  -4.393 1.45e-05 ***\n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\nResidual standard error: 745.8 on 380 degrees of freedom\nMultiple R-squared:  0.04833,   Adjusted R-squared:  0.04582 \nF-statistic:  19.3 on 1 and 380 DF,  p-value: 1.452e-05\n\nwm %&gt;% \n  ggplot(aes(inc, yld , group = factor(study))) +\n  geom_point() +\n  theme_minimal() +\n  geom_smooth(method = \"lm\", se = F) \n\n\n\nmofo1 &lt;- lm(yld ~ inc,\n            data = wm)\nsummary(mofo1)\n\n\nCall:\nlm(formula = yld ~ inc, data = wm)\n\nResiduals:\n     Min       1Q   Median       3Q      Max \n-1657.85  -594.50   -91.32   531.76  1693.15 \n\nCoefficients:\n            Estimate Std. Error t value Pr(&gt;|t|)    \n(Intercept) 3299.619     56.451  58.451  &lt; 2e-16 ***\ninc           -9.261      2.108  -4.393 1.45e-05 ***\n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\nResidual standard error: 745.8 on 380 degrees of freedom\nMultiple R-squared:  0.04833,   Adjusted R-squared:  0.04582 \nF-statistic:  19.3 on 1 and 380 DF,  p-value: 1.452e-05\n\n\n\nlibrary(broom)\n\nmofo2 &lt;- wm %&gt;% \n  group_by(study) %&gt;% \n  do (tidy(lm(.$yld ~ .$inc), conf.int = TRUE))\nmofo2\n\n# A tibble: 70 × 8\n# Groups:   study [35]\n   study term        estimate std.error statistic  p.value conf.low conf.high\n   &lt;dbl&gt; &lt;chr&gt;          &lt;dbl&gt;     &lt;dbl&gt;     &lt;dbl&gt;    &lt;dbl&gt;    &lt;dbl&gt;     &lt;dbl&gt;\n 1     1 (Intercept)  3329.       86.8      38.3  4.60e-13   3138.    3520.  \n 2     1 .$inc         -14.2       2.08     -6.85 2.78e- 5    -18.8     -9.64\n 3     2 (Intercept)  2682.       48.6      55.2  8.55e-15   2575.    2789.  \n 4     2 .$inc          -6.93      1.49     -4.66 6.89e- 4    -10.2     -3.66\n 5     3 (Intercept)  4017.       61.6      65.2  1.37e-15   3882.    4153.  \n 6     3 .$inc         -18.6       1.71    -10.9  3.11e- 7    -22.4    -14.9 \n 7     4 (Intercept)  2814.      151.       18.6  1.15e- 9   2481.    3147.  \n 8     4 .$inc         -43.5      16.8      -2.58 2.56e- 2    -80.5     -6.38\n 9     5 (Intercept)  3317.      234.       14.2  2.07e- 8   2802.    3832.  \n10     5 .$inc         -21.2       5.69     -3.72 3.36e- 3    -33.7     -8.67\n# ℹ 60 more rows\n\n#p3 &lt;- fit_all |&gt; \n # filter(term == \"(Intercept)\") |&gt; \n # ggplot(aes(x = estimate))+\n # geom_histogram(bins = 8, color = \"white\", fill = \"gray50\")+\n #theme_r4pde()+\n  #labs(x = \"Intercept\", y = \"Frequency\")\n\n#p4 &lt;- fit_all |&gt; \n  #filter(term == \".$inc\") |&gt; \n  #ggplot(aes(x = estimate))+\n  #geom_histogram(bins = 8, color = \"white\", fill = \"gray50\")+\n  #theme_r4pde()+\n  #labs(x = \"Slope\", y = \"Frequency\")\n\n\nlibrary(patchwork)\n#p3|p4\n\n\ndf &lt;- mofo2 %&gt;%  filter(term == \".$inc\")\nmean(df$estimate)\n\n[1] -19.52932\n\nlibrary(patchwork)\n#p3|p4\n\n\nlibrary(lme4)\n\nmofo3 &lt;- lmer(yld ~ inc + (inc | study), data = wm,\n              REML = F)\n\nsummary(mofo3)\n\nLinear mixed model fit by maximum likelihood  ['lmerMod']\nFormula: yld ~ inc + (inc | study)\n   Data: wm\n\n     AIC      BIC   logLik deviance df.resid \n  5319.4   5343.1  -2653.7   5307.4      376 \n\nScaled residuals: \n    Min      1Q  Median      3Q     Max \n-3.7078 -0.5991 -0.0295  0.5077  3.2364 \n\nRandom effects:\n Groups   Name        Variance  Std.Dev. Corr \n study    (Intercept) 557573.08 746.708       \n          inc             36.85   6.071  -0.29\n Residual              37228.73 192.947       \nNumber of obs: 382, groups:  study, 35\n\nFixed effects:\n            Estimate Std. Error t value\n(Intercept) 3455.432    128.063   26.98\ninc          -17.236      1.451  -11.88\n\nCorrelation of Fixed Effects:\n    (Intr)\ninc -0.300\noptimizer (nloptwrap) convergence code: 0 (OK)\nModel failed to converge with max|grad| = 0.416806 (tol = 0.002, component 1)\n\nAnova(mofo3)\n\nAnalysis of Deviance Table (Type II Wald chisquare tests)\n\nResponse: yld\n     Chisq Df Pr(&gt;Chisq)    \ninc 141.09  1  &lt; 2.2e-16 ***\n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\n#confint(mofo3, method = \"wald\")"
  }
]